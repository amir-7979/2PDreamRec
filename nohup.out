Fold 1 Epoch 006; Train loss: 0.3513; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1985; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1734; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2798; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1535; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1337; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.481788   0.329676   0.764901   0.419369  
Loss: 0.1296
Fold 1 Epoch 008; Train loss: 0.3067; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.1266; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1113; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.3043; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.1051; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1091; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2861; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.342715   0.251458   0.455298   0.288235   0.528146   0.307000  
Loss: 0.3807
Fold 1 Epoch 015; Train loss: 0.1884; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1181; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2467; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0789; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.3133; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0755; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0699; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2808; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0686; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.409689   0.774834   0.482663  
Loss: 0.0759
Fold 1 Epoch 021; Train loss: 0.0652; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.2388; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0639; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2104; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0619; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0597; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.3127; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0579; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0561; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1951; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0582; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2666; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0651; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0866; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1949; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.0789; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.409825   0.624172   0.434742  
Loss: 0.0900
Fold 1 Epoch 031; Train loss: 0.0535; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2894; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.372517   0.287189   0.465232   0.317110   0.546358   0.338003  
Loss: 0.3651
Fold 1 Epoch 032; Train loss: 0.0502; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0476; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.2622; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0469; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0459; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.2561; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.0444; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0451; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.2762; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0427; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0417; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.3062; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0405; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.521523   0.390332   0.645695   0.429349  
Loss: 0.0520
Fold 1 Epoch 025; Train loss: 0.2416; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0408; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0392; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.2726; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0391; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0392; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.2661; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0379; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0459; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.3784; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0782; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0553; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.4323; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0358; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0340; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.518212   0.372506   0.596026   0.397067  
Loss: 0.0408
Fold 1 Epoch 030; Train loss: 0.4294; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.162252   0.107369   0.245033   0.133337   0.319536   0.152394  
Loss: 0.5104
Fold 1 Epoch 051; Train loss: 0.0322; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0317; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.4652; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0311; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0297; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.6282; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0305; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0302; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.6010; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0286; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0287; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.5877; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0278; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.5705; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0276; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.473510   0.383993   0.528146   0.401593  
Loss: 0.0311
Fold 1 Epoch 061; Train loss: 0.0274; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.5957; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0268; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0270; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.5563; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0250; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.5605; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0254; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.5830; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0269; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0286; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.5725; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.029801   0.020958   0.051325   0.028015   0.084437   0.036354  
Loss: 0.6418
Fold 1 Epoch 070; Train loss: 0.0295; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.538079   0.409607   0.619205   0.434981  
Loss: 0.0399
Fold 1 Epoch 071; Train loss: 0.0271; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.5763; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0245; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0227; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.5849; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0214; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.5708; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0202; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0210; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.5700; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0207; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.5518; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0199; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.463576   0.356466   0.569536   0.390630  
Loss: 0.0253
Fold 1 Epoch 046; Train loss: 0.5656; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0198; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0212; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.5628; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0235; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.5879; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0292; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0246; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.5507; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0189; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0189; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.5840; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.031457   0.021411   0.051325   0.027855   0.074503   0.033668  
Loss: 0.6486
Fold 1 Epoch 090; Train loss: 0.0179; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.412252   0.333204   0.541391   0.374183  
Loss: 0.0195
Fold 1 Epoch 051; Train loss: 0.5799; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0183; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0184; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0171; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.5753; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0175; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0176; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.5635; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0175; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0175; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.5661; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0171; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0174; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.5670; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0187; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.443709   0.331413   0.649007   0.394690  
Loss: 0.0246
[lr candidate 0.05] Fold 1: HR@10 = [np.float64(0.7649006622516556), np.float64(0.7748344370860927), np.float64(0.6241721854304636), np.float64(0.6456953642384106), np.float64(0.5960264900662252), np.float64(0.5281456953642384), np.float64(0.6192052980132451), np.float64(0.5695364238410596), np.float64(0.5413907284768212), np.float64(0.6490066225165563)]
Tuning lr:  25%|██▌       | 1/4 [02:09<06:29, 129.88s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 056; Train loss: 0.5517; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6126; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2179; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.5822; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1441; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1110; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.5685; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.0987; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.0876; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.5741; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.0790; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.0788; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.5855; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.029801   0.020771   0.051325   0.027804   0.079470   0.034789  
Loss: 0.6523
Fold 1 Epoch 009; Train loss: 0.0756; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0726; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.470199   0.368847   0.617550   0.416571  
Loss: 0.0910
Fold 1 Epoch 061; Train loss: 0.5619; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.0717; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0692; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.5749; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.0664; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0669; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.5538; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0658; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0662; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0621; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.5624; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0596; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.5584; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0601; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0594; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.456954   0.339537   0.642384   0.398916  
Loss: 0.0734
Fold 1 Epoch 066; Train loss: 0.5741; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0565; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0574; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.5749; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0553; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0537; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.5851; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0536; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0530; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0504; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.5726; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0495; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0478; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.5652; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.031457   0.021411   0.056291   0.029290   0.082781   0.035760  
Loss: 0.6557
Fold 1 Epoch 030; Train loss: 0.0489; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.615894   0.465078   0.740066   0.504505  
Loss: 0.0615
Fold 1 Epoch 031; Train loss: 0.0471; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.5798; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0456; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0444; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.5655; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0428; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0414; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.5697; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.0411; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0402; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.5603; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0389; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.5553; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0369; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0377; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.458609   0.346402   0.596026   0.390915  
Loss: 0.0467
Fold 1 Epoch 076; Train loss: 0.5780; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0375; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0353; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.5594; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0350; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0329; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.5580; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0326; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0310; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.5528; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0307; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0295; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.5652; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.033113   0.022239   0.049669   0.027614   0.074503   0.033997  
Loss: 0.6586
Fold 1 Epoch 049; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0281; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.630795   0.504934   0.710265   0.530833  
Loss: 0.0359
Fold 1 Epoch 081; Train loss: 0.5668; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0271; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0280; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.5658; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0260; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0264; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.5511; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0252; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0250; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.5842; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.5860; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0241; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0231; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.509934   0.348697   0.637417   0.389508  
Loss: 0.0274
Fold 1 Epoch 086; Train loss: 0.5855; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0220; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0214; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.5665; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0209; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.5651; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0195; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0189; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.5629; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0191; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0190; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.5785; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.033113   0.022124   0.052980   0.028524   0.081126   0.035655  
Loss: 0.6615
Fold 1 Epoch 069; Train loss: 0.0172; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0175; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.571192   0.450475   0.701987   0.492477  
Loss: 0.0181
Fold 1 Epoch 091; Train loss: 0.5600; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0167; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0168; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.5639; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0157; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0163; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.5695; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0153; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.5727; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0152; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.5855; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0152; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0152; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.622517   0.480531   0.748344   0.521245  
Loss: 0.0159
Fold 1 Epoch 096; Train loss: 0.5683; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0147; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0144; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.5602; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0139; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0142; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.5847; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0134; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0126; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.5658; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0133; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.5517; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.029801   0.020843   0.049669   0.027398   0.081126   0.035364  
Loss: 0.6637
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.029801   0.020843   0.049669   0.027398   0.081126   0.035364  
Loss: 0.6637
Fold 1: Final Test Loss: 0.6637, HR@5: 0.0298
[lr candidate 0.05] Fold 1: Loss = 0.6637
Tuning lr based on loss:  25%|██▌       | 1/4 [04:03<12:10, 243.53s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 089; Train loss: 0.0125; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0117; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.619205   0.477487   0.786424   0.531528  
Loss: 0.0123
Fold 1 Epoch 001; Train loss: 0.6273; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0115; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0113; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5687; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0107; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4657; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0104; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0101; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4872; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0091; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0089; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.2799; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0080; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0073; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.2471; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0067; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.561258   0.351746   0.874172   0.448009  
Loss: 0.0070
[lr candidate 0.01] Fold 1: HR@10 = [np.float64(0.6175496688741722), np.float64(0.6423841059602649), np.float64(0.7400662251655629), np.float64(0.5960264900662252), np.float64(0.7102649006622517), np.float64(0.6374172185430463), np.float64(0.7019867549668874), np.float64(0.7483443708609272), np.float64(0.7864238410596026), np.float64(0.8741721854304636)]
Tuning lr:  50%|█████     | 2/4 [04:13<04:12, 126.10s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.7157; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2624; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.3316; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.2053; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2015; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1562; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1264; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2091; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1103; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1541; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
Fold 1 Epoch 007; Train loss: 0.1019; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.538079   0.444827   0.596026   0.463686   0.647351   0.476464  
Loss: 0.3998
Fold 1 Epoch 008; Train loss: 0.0951; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.1841; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.0906; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0869; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.529801   0.414532   0.675497   0.462341  
Loss: 0.1085
Fold 1 Epoch 012; Train loss: 0.1264; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.0830; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0803; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1276; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.0777; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0781; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1261; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0733; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0721; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1621; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0705; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0688; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1126; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0678; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0705; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.564570   0.436893   0.698675   0.480473  
Loss: 0.0843
Fold 1 Epoch 017; Train loss: 0.1045; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0675; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0671; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1396; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0660; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0655; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0871; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0639; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0648; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0819; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.670530   0.585758   0.723510   0.603136   0.754967   0.611171  
Loss: 0.3094
Fold 1 Epoch 027; Train loss: 0.0632; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0611; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.0971; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0603; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0614; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.498344   0.403678   0.615894   0.441730  
Loss: 0.0719
Fold 1 Epoch 022; Train loss: 0.1208; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0596; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0583; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1216; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0586; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0571; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0628; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0577; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0570; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1022; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0568; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0548; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1043; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0536; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0538; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 027; Train loss: 0.0593; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.483444   0.385645   0.629139   0.433240  
Loss: 0.0691
Fold 1 Epoch 041; Train loss: 0.0529; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0881; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0523; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0519; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0936; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0521; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0500; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0470; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.741722   0.645582   0.778146   0.657295   0.798013   0.662216  
Loss: 0.2638
Fold 1 Epoch 046; Train loss: 0.0500; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0496; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.0532; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0489; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0489; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0493; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 032; Train loss: 0.0686; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.519868   0.392421   0.658940   0.436682  
Loss: 0.0585
Fold 1 Epoch 051; Train loss: 0.0479; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0483; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0940; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0468; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0457; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1171; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0453; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0440; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0661; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0443; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0423; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0471; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0436; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0422; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.569536   0.432689   0.673841   0.466417  
Loss: 0.0502
Fold 1 Epoch 037; Train loss: 0.0932; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0410; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0416; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0781; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0400; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0415; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0386; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0398; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0400; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0791; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.743377   0.667065   0.779801   0.678929   0.809603   0.686411  
Loss: 0.2369
Fold 1 Epoch 067; Train loss: 0.0389; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0397; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0391; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0379; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0381; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.619205   0.487044   0.723510   0.520733  
Loss: 0.0450
Fold 1 Epoch 042; Train loss: 0.0530; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0376; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0372; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0348; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0360; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0366; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0425; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0355; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0357; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0344; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0702; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0337; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0341; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0422; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0334; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.446205   0.705298   0.485505  
Loss: 0.0400
Fold 1 Epoch 047; Train loss: 0.0271; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0328; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0330; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0269; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0328; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0315; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0312; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0484; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0310; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0305; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0529; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.761589   0.704679   0.788079   0.713459   0.816225   0.720725  
Loss: 0.2101
Fold 1 Epoch 088; Train loss: 0.0295; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0536; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0292; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.536424   0.413057   0.650662   0.449559  
Loss: 0.0334
Fold 1 Epoch 091; Train loss: 0.0285; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0613; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0281; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0273; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0275; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0330; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0273; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0259; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0361; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0263; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0256; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0447; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0257; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0262; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.650662   0.505883   0.759934   0.540344  
Loss: 0.0271
[lr candidate 0.005] Fold 1: HR@10 = [np.float64(0.6754966887417219), np.float64(0.6986754966887417), np.float64(0.6158940397350994), np.float64(0.6291390728476821), np.float64(0.6589403973509934), np.float64(0.6738410596026491), np.float64(0.7235099337748344), np.float64(0.7052980132450332), np.float64(0.6506622516556292), np.float64(0.7599337748344371)]
Tuning lr:  75%|███████▌  | 3/4 [06:17<02:05, 125.20s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 056; Train loss: 0.0576; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 1.2217; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.9203; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0270; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.7217; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5930; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0440; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.4982; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.4211; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0341; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.3615; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3179; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2818; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0428; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.779801   0.706983   0.799669   0.713646   0.819536   0.718661  
Loss: 0.2036
Fold 1 Epoch 010; Train loss: 0.2575; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.597682   0.488850   0.728477   0.531127  
Loss: 0.3540
Fold 1 Epoch 011; Train loss: 0.2324; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0416; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.2132; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1974; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0460; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.1887; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1737; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0645; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.1636; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1603; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0320; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.1526; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1441; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0486; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.1413; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.479942   0.705298   0.519401  
Loss: 0.1976
Fold 1 Epoch 021; Train loss: 0.1328; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0796; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.1287; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1291; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0312; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.1241; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1192; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0257; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.1181; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1157; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0588; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.1120; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1118; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0546; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.786424   0.715952   0.804636   0.721863   0.819536   0.725588  
Loss: 0.2018
Fold 1 Epoch 030; Train loss: 0.1099; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.586093   0.473103   0.711921   0.513965  
Loss: 0.1505
Fold 1 Epoch 031; Train loss: 0.1069; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0206; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.1030; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1033; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1032; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0291; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.1028; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0990; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0315; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0980; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0979; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0380; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0953; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0956; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.609272   0.491637   0.733444   0.531298  
Loss: 0.1229
Fold 1 Epoch 075; Train loss: 0.0615; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0932; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0945; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0645; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0919; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0905; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0897; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0317; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0892; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0877; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0157; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0896; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0876; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0234; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0881; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.569536   0.462854   0.705298   0.506105  
Loss: 0.1150
Fold 1 Epoch 051; Train loss: 0.0895; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0149; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.791391   0.732014   0.807947   0.737601   0.819536   0.740634  
Loss: 0.1853
Fold 1 Epoch 052; Train loss: 0.0850; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0871; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0270; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.0847; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0827; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0220; Time: 00:00:02
Fold 1 Epoch 056; Train loss: 0.0840; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0834; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0835; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0625; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0821; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0809; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.615894   0.498961   0.766556   0.547312  
Loss: 0.1073
Fold 1 Epoch 084; Train loss: 0.0494; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0838; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0823; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0249; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0846; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0799; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0266; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0812; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0803; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0206; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0801; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0807; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0347; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0784; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0791; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.435197   0.688742   0.481009  
Loss: 0.0998
Fold 1 Epoch 089; Train loss: 0.0150; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0771; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0781; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0776; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0095; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.783113   0.717475   0.806291   0.724945   0.817881   0.727910  
Loss: 0.1862
Fold 1 Epoch 074; Train loss: 0.0793; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0757; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0356; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0757; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0751; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0478; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0764; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0764; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0343; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0753; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.432034   0.690397   0.479748  
Loss: 0.0933
Fold 1 Epoch 081; Train loss: 0.0758; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0441; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0741; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0749; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0703; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0736; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0755; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0725; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0176; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0741; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0746; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0177; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0717; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0744; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.476028   0.703642   0.515020  
Loss: 0.0915
Fold 1 Epoch 098; Train loss: 0.0614; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0717; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0721; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0187; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0730; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0718; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0206; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.783113   0.737025   0.809603   0.745899   0.822848   0.749197  
Loss: 0.1821
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.793046   0.737359   0.816225   0.744906   0.824503   0.747021  
Loss: 0.1817
Fold 1: Final Test Loss: 0.1817, HR@5: 0.7930
[lr candidate 0.01] Fold 1: Loss = 0.1817
Tuning lr based on loss:  50%|█████     | 2/4 [08:20<08:23, 251.53s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 095; Train loss: 0.0719; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0712; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6519; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0722; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0710; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5861; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0703; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0697; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.538079   0.436892   0.663907   0.477165  
Loss: 0.0908
[lr candidate 0.001] Fold 1: HR@10 = [np.float64(0.7284768211920529), np.float64(0.7052980132450332), np.float64(0.7119205298013245), np.float64(0.7334437086092715), np.float64(0.7052980132450332), np.float64(0.7665562913907285), np.float64(0.6887417218543046), np.float64(0.6903973509933775), np.float64(0.7036423841059603), np.float64(0.6639072847682119)]
Tuning lr: 100%|██████████| 4/4 [08:22<00:00, 125.27s/it]Tuning lr: 100%|██████████| 4/4 [08:22<00:00, 125.71s/it]

Best learning rate found: 0.01
Tuning optimizer:   0%|          | 0/4 [00:00<?, ?it/s]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 003; Train loss: 0.5579; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6116; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2206; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5034; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1543; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1064; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4573; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.0949; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.0885; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3666; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.0785; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.0771; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2793; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.0741; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0735; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
Fold 1 Epoch 008; Train loss: 0.2464; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.630795   0.488139   0.748344   0.526184  
Loss: 0.0896
Fold 1 Epoch 011; Train loss: 0.0693; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1961; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.0675; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0672; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0648; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2577; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.460265   0.374114   0.518212   0.393064   0.586093   0.410220  
Loss: 0.4684
Fold 1 Epoch 015; Train loss: 0.0623; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0621; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.1961; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0602; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0598; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2103; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0571; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0586; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.521523   0.403990   0.668874   0.451408  
Loss: 0.0727
Fold 1 Epoch 013; Train loss: 0.1774; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0555; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0536; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1156; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0540; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0528; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1320; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0515; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0502; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1683; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0502; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0484; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0902; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0460; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0449; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.572848   0.463028   0.683775   0.499062  
Loss: 0.0563
Fold 1 Epoch 018; Train loss: 0.1163; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0444; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0428; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1151; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0433; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0439; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1132; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.639073   0.565865   0.682119   0.579701   0.723510   0.590294  
Loss: 0.4038
Fold 1 Epoch 035; Train loss: 0.0405; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0395; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1264; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0369; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0379; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0784; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0370; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0353; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.566225   0.469056   0.677152   0.505141  
Loss: 0.0440
Fold 1 Epoch 023; Train loss: 0.1269; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0347; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0348; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0707; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0335; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0318; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0494; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0318; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0312; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0702; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0303; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0296; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1044; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0291; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0285; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.567881   0.467316   0.678808   0.503267  
Loss: 0.0362
Fold 1 Epoch 028; Train loss: 0.0909; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0273; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0466; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0258; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0674; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.701987   0.635137   0.748344   0.650277   0.773179   0.656560  
Loss: 0.3549
Fold 1 Epoch 055; Train loss: 0.0247; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0240; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.0821; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0234; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0604; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0223; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0218; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.521523   0.428275   0.642384   0.467001  
Loss: 0.0238
Fold 1 Epoch 033; Train loss: 0.0678; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0216; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0561; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0205; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0189; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0655; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0190; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0182; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0798; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0180; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0167; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0285; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0166; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0166; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.559603   0.463172   0.660596   0.495992  
Loss: 0.0181
Fold 1 Epoch 038; Train loss: 0.0335; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0154; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0275; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0148; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0149; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0402; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.738411   0.666161   0.769868   0.676428   0.793046   0.682221  
Loss: 0.2934
Fold 1 Epoch 075; Train loss: 0.0143; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0136; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0133; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0540; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0131; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0125; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0511; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0125; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.427876   0.678808   0.471584  
Loss: 0.0124
Fold 1 Epoch 081; Train loss: 0.0112; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0244; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0109; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0104; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0329; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0098; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0094; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0374; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0092; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0086; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0491; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0081; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0342; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0075; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.521523   0.403070   0.842715   0.504441  
Loss: 0.0085
Fold 1 Epoch 091; Train loss: 0.0069; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0331; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0067; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0063; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0517; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0056; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0051; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0046; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0355; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.756623   0.691897   0.781457   0.699796   0.812914   0.707970  
Loss: 0.3052
Fold 1 Epoch 097; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0037; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0394; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0031; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0026; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.405807   0.894040   0.517985  
Loss: 0.0028
[optimizer candidate nadam] Fold 1: HR@10 = [np.float64(0.7483443708609272), np.float64(0.6688741721854304), np.float64(0.6837748344370861), np.float64(0.6771523178807947), np.float64(0.6788079470198676), np.float64(0.6423841059602649), np.float64(0.6605960264900662), np.float64(0.6788079470198676), np.float64(0.8427152317880795), np.float64(0.8940397350993378)]
Tuning optimizer:  25%|██▌       | 1/4 [02:04<06:13, 124.58s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 052; Train loss: 0.0497; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 1.0715; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.8062; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0321; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.6614; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5345; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0423; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.4340; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3549; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0341; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.2945; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2395; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0594; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1983; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1693; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.574503   0.429731   0.706954   0.472869  
Loss: 0.2315
Fold 1 Epoch 057; Train loss: 0.0506; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.1467; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1284; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0371; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.1153; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1032; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0348; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0956; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0866; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0350; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
Fold 1 Epoch 017; Train loss: 0.0826; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.753311   0.694712   0.786424   0.705698   0.812914   0.712354  
Loss: 0.2724
Fold 1 Epoch 018; Train loss: 0.0769; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0737; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0358; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0723; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.417219   0.330044   0.592715   0.386916  
Loss: 0.0922
Fold 1 Epoch 021; Train loss: 0.0680; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0240; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0649; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0620; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0078; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.0600; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0590; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0344; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.0579; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0562; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0317; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0537; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0527; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0274; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.0515; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.416497   0.690397   0.463616  
Loss: 0.0603
Fold 1 Epoch 031; Train loss: 0.0497; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0583; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0478; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0479; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0333; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0470; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0456; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0346; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.0436; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0432; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0171; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.779801   0.731643   0.807947   0.740796   0.817881   0.743359  
Loss: 0.2484
Fold 1 Epoch 038; Train loss: 0.0420; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0409; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0398; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 071; Train loss: 0.0170; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.491722   0.376834   0.649007   0.427826  
Loss: 0.0456
Fold 1 Epoch 041; Train loss: 0.0392; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0366; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0181; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0372; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0356; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0269; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0349; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0338; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0414; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0335; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0320; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0438; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0310; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0304; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.476821   0.343519   0.630795   0.393324  
Loss: 0.0337
Fold 1 Epoch 076; Train loss: 0.0594; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0297; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0282; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0158; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0276; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0268; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0260; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0309; Time: 00:00:02
Fold 1 Epoch 056; Train loss: 0.0260; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0243; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0419; Time: 00:00:02
Fold 1 Epoch 058; Train loss: 0.0245; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0234; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0197; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.791391   0.738180   0.807947   0.743456   0.821192   0.746808  
Loss: 0.2316
Fold 1 Epoch 060; Train loss: 0.0227; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.491722   0.360139   0.647351   0.410872  
Loss: 0.0229
Fold 1 Epoch 061; Train loss: 0.0207; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0429; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0212; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0203; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0319; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0197; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0191; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0297; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0187; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0178; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0104; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0163; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0415; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0152; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.451987   0.321290   0.655629   0.386747  
Loss: 0.0161
Fold 1 Epoch 071; Train loss: 0.0147; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0287; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0139; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0133; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0265; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0127; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0117; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0303; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0110; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0103; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0090; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0438; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0087; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0078; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.380795   0.284250   0.597682   0.354349  
Loss: 0.0082
Fold 1 Epoch 090; Train loss: 0.0222; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.799669   0.757588   0.807947   0.760320   0.814570   0.761979  
Loss: 0.2201
Fold 1 Epoch 081; Train loss: 0.0070; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0065; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0273; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0058; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0051; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0194; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0045; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0044; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0164; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0039; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0034; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0153; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0029; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0022; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.354305   0.212850   0.908940   0.393390  
Loss: 0.0020
Fold 1 Epoch 095; Train loss: 0.0311; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0087; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0213; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0168; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0596; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.072848   0.041425   0.663907   0.223484  
Loss: 0.0001
[optimizer candidate lamb] Fold 1: HR@10 = [np.float64(0.706953642384106), np.float64(0.5927152317880795), np.float64(0.6903973509933775), np.float64(0.6490066225165563), np.float64(0.6307947019867549), np.float64(0.6473509933774835), np.float64(0.6556291390728477), np.float64(0.597682119205298), np.float64(0.9089403973509934), np.float64(0.6639072847682119)]
Tuning optimizer:  50%|█████     | 2/4 [04:11<04:11, 125.86s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.5885; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0346; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.799669   0.751731   0.822848   0.759389   0.827815   0.760639  
Loss: 0.2115
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.793046   0.739612   0.812914   0.746131   0.822848   0.748647  
Loss: 0.2158
Fold 1: Final Test Loss: 0.2158, HR@5: 0.7930
[lr candidate 0.005] Fold 1: Loss = 0.2158
Tuning lr based on loss:  75%|███████▌  | 3/4 [12:40<04:15, 255.29s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 002; Train loss: 0.2290; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1599; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6596; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1172; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1009; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.6511; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.0870; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.0825; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.6187; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.0777; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5900; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.0742; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0708; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.428808   0.287437   0.625828   0.349892  
Loss: 0.0910
Fold 1 Epoch 005; Train loss: 0.5684; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.0694; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0683; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.5659; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.0665; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0654; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.5559; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0655; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0644; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.5326; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0627; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0619; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.5072; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0608; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0623; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.437086   0.312118   0.682119   0.391253  
Loss: 0.0699
Fold 1 Epoch 010; Train loss: 0.4567; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.157285   0.123374   0.197020   0.136287   0.248344   0.149274  
Loss: 0.5813
Fold 1 Epoch 021; Train loss: 0.0581; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0590; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.4042; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0571; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0580; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.4359; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0566; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.3975; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.0544; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0557; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.3702; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0548; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0526; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.3562; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.0515; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.405445   0.710265   0.459208  
Loss: 0.0624
Fold 1 Epoch 031; Train loss: 0.0511; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2775; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0499; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0486; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.2327; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0489; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0480; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2012; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.0467; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0464; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.2182; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0452; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0440; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2060; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.501656   0.412539   0.576159   0.436493   0.639073   0.452418  
Loss: 0.6528
Fold 1 Epoch 040; Train loss: 0.0433; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.408940   0.275360   0.624172   0.344822  
Loss: 0.0495
Fold 1 Epoch 021; Train loss: 0.1785; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0431; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0419; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1702; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0407; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0398; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1914; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0386; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0390; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1439; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0386; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0379; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1225; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0377; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0350; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.491722   0.334846   0.716887   0.406098  
Loss: 0.0393
Fold 1 Epoch 026; Train loss: 0.1073; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0349; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0339; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1140; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0338; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0331; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1408; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0325; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0313; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1015; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0312; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0313; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1232; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 059; Train loss: 0.0294; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.602649   0.524303   0.660596   0.543197   0.697020   0.552511  
Loss: 0.6188
Fold 1 Epoch 060; Train loss: 0.0292; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.466887   0.339951   0.721854   0.420518  
Loss: 0.0324
Fold 1 Epoch 031; Train loss: 0.1290; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0276; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0279; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1114; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0279; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0268; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1170; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0258; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1101; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0244; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0248; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0654; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0240; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.268212   0.179174   0.627483   0.291484  
Loss: 0.0248
Fold 1 Epoch 071; Train loss: 0.0233; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1476; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0231; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0229; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1020; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0225; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0218; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1012; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0211; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0208; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0639; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0201; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0199; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.453642   0.323169   0.826159   0.438940  
Loss: 0.0172
Fold 1 Epoch 040; Train loss: 0.0703; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.658940   0.590243   0.713576   0.608520   0.758278   0.619928  
Loss: 0.5937
Fold 1 Epoch 081; Train loss: 0.0189; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0180; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0530; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0181; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0177; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0856; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0174; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0172; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0928; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0166; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0155; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0811; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0148; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0145; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.524834   0.356777   0.875828   0.466242  
Loss: 0.0139
Fold 1 Epoch 045; Train loss: 0.0590; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0143; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0134; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0814; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0120; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0499; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0116; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0115; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0659; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0104; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0103; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0683; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0096; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0091; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.403974   0.261842   0.836093   0.401714  
Loss: 0.0086
[optimizer candidate adamw] Fold 1: HR@10 = [np.float64(0.6258278145695364), np.float64(0.6821192052980133), np.float64(0.7102649006622517), np.float64(0.6241721854304636), np.float64(0.7168874172185431), np.float64(0.7218543046357616), np.float64(0.6274834437086093), np.float64(0.8261589403973509), np.float64(0.8758278145695364), np.float64(0.8360927152317881)]
Tuning optimizer:  75%|███████▌  | 3/4 [06:15<02:05, 125.30s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
[31mPlease check your arguments if you have upgraded adabelief-pytorch from version 0.0.5.
[31mModifications to default arguments:
[31m                           eps  weight_decouple    rectify
-----------------------  -----  -----------------  ---------
adabelief-pytorch=0.0.5  1e-08  False              False
>=0.1.0 (Current 0.2.0)  1e-16  True               True
[34mSGD better than Adam (e.g. CNN for Image Classification)    Adam better than SGD (e.g. Transformer, GAN)
----------------------------------------------------------  ----------------------------------------------
Recommended eps = 1e-8                                      Recommended eps = 1e-16
[34mFor a complete table of recommended hyperparameters, see
[34mhttps://github.com/juntang-zhuang/Adabelief-Optimizer
[32mYou can disable the log message by setting "print_change_log = False", though it is recommended to keep as a reminder.
[0m
Weight decoupling enabled in AdaBelief
Rectification enabled in AdaBelief
Fold 1 Epoch 050; Train loss: 0.0990; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.693709   0.619933   0.726821   0.630282   0.758278   0.638176  
Loss: 0.5566
Fold 1 Epoch 001; Train loss: 1.3101; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 1.2722; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0567; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 1.2507; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 1.2257; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0344; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 1.1929; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 1.1625; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0618; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 1.1242; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 1.0874; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0567; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 1.0508; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 1.0125; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.460265   0.250759   0.695364   0.325252  
Loss: 0.9520
Fold 1 Epoch 055; Train loss: 0.1137; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.9759; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.9376; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0975; Time: 00:00:03
Fold 1 Epoch 013; Train loss: 0.9012; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.8686; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0924; Time: 00:00:03
Fold 1 Epoch 015; Train loss: 0.8342; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.8028; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.7725; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0610; Time: 00:00:03
Fold 1 Epoch 018; Train loss: 0.7469; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.7189; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0455; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.6908; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.548013   0.416564   0.819536   0.500095  
Loss: 0.7309
Fold 1 Epoch 060; Train loss: 0.0365; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.720199   0.664962   0.764901   0.679329   0.781457   0.683550  
Loss: 0.5313
Fold 1 Epoch 021; Train loss: 0.6705; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.6449; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.6258; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0701; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.6000; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.5827; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0569; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.5659; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.5480; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0460; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.5324; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.5201; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0645; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.5003; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.549669   0.418844   0.832781   0.507255  
Loss: 0.5926
Fold 1 Epoch 031; Train loss: 0.4881; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0239; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.4767; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.4620; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0559; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.4500; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.4395; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0548; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.4299; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.4232; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0426; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.4067; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.4010; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0276; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.3919; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.556291   0.423009   0.852649   0.515961  
Loss: 0.5030
Fold 1 Epoch 041; Train loss: 0.3826; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0593; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.725166   0.671918   0.759934   0.683294   0.793046   0.691799  
Loss: 0.4833
Fold 1 Epoch 042; Train loss: 0.3742; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.3706; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0661; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.3597; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.3492; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0320; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.3485; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.3414; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0401; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.3342; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.3309; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0491; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.3246; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.556291   0.421283   0.846026   0.514614  
Loss: 0.4319
Fold 1 Epoch 051; Train loss: 0.3241; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0354; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.3178; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.3107; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0421; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.3059; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.3020; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.2955; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0388; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.2933; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.2872; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0568; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.2826; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.2767; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.422608   0.826159   0.512187  
Loss: 0.3935
Fold 1 Epoch 079; Train loss: 0.0370; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.2769; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.2717; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0469; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.726821   0.676423   0.756623   0.686373   0.778146   0.691683  
Loss: 0.4326
Fold 1 Epoch 063; Train loss: 0.2744; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.2676; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0210; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.2678; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.2618; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0175; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.2594; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.2536; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0429; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.2521; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.2523; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.554636   0.425811   0.798013   0.504208  
Loss: 0.3530
Fold 1 Epoch 084; Train loss: 0.0208; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.2526; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.2458; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0340; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.2425; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.2383; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0224; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.2383; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.2372; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0129; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.2298; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.2366; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.2280; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0396; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.2310; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.434493   0.758278   0.501456  
Loss: 0.3214
Fold 1 Epoch 081; Train loss: 0.2261; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0242; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.2263; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.2236; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0357; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.738411   0.680314   0.771523   0.691219   0.791391   0.696325  
Loss: 0.4233
Fold 1 Epoch 084; Train loss: 0.2226; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.2172; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0312; Time: 00:00:03
Fold 1 Epoch 086; Train loss: 0.2181; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.2149; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0241; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.2133; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.2139; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0444; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.2129; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.559603   0.443017   0.759934   0.507534  
Loss: 0.2946
Fold 1 Epoch 091; Train loss: 0.2094; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.2112; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0102; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.2053; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.2068; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0753; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.2015; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.1999; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0100; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.2019; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.1967; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0193; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.1967; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1954; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.541391   0.432476   0.756623   0.501645  
Loss: 0.2772
[optimizer candidate adabelief] Fold 1: HR@10 = [np.float64(0.695364238410596), np.float64(0.8195364238410596), np.float64(0.8327814569536424), np.float64(0.8526490066225165), np.float64(0.8460264900662252), np.float64(0.8261589403973509), np.float64(0.7980132450331126), np.float64(0.7582781456953642), np.float64(0.7599337748344371), np.float64(0.7566225165562914)]
Tuning optimizer: 100%|██████████| 4/4 [08:24<00:00, 126.69s/it]Tuning optimizer: 100%|██████████| 4/4 [08:24<00:00, 126.19s/it]

Best optimizer found: nadam
Tuning timesteps:   0%|          | 0/5 [00:00<?, ?it/s]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 098; Train loss: 0.0300; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6615; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2379; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0213; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1444; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1171; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1023; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0229; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.738411   0.685173   0.769868   0.695248   0.796358   0.702032  
Loss: 0.4036
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.723510   0.678341   0.758278   0.689485   0.783113   0.695973  
Loss: 0.4142
Fold 1: Final Test Loss: 0.4142, HR@5: 0.7235
[lr candidate 0.001] Fold 1: Loss = 0.4142
Tuning lr based on loss: 100%|██████████| 4/4 [16:58<00:00, 256.45s/it]Tuning lr based on loss: 100%|██████████| 4/4 [16:58<00:00, 254.67s/it]

Best learning rate based on loss: 0.01
Tuning data for lr (loss) saved to ./item/tuning_lr.json
Tuning optimizer based on loss:   0%|          | 0/4 [00:00<?, ?it/s]
========== Fold 1 ==========
3883
Fold 1 Epoch 006; Train loss: 0.0912; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.0858; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.5958; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.0804; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.0776; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5742; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.0731; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.438798   0.695364   0.487458  
Loss: 0.0924
Fold 1 Epoch 011; Train loss: 0.0717; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5352; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.0698; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0720; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5029; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0651; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0638; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4649; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0619; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0616; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3852; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0600; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0587; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.3882; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0593; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.576159   0.438055   0.725166   0.485977  
Loss: 0.0737
Fold 1 Epoch 021; Train loss: 0.0568; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3186; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0558; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0548; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.3128; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.0532; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0512; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2558; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.392384   0.316419   0.443709   0.333025   0.496689   0.346352  
Loss: 0.4297
Fold 1 Epoch 026; Train loss: 0.0525; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0492; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2767; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0491; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0469; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0484; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 012; Train loss: 0.2655; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.548013   0.414482   0.697020   0.461658  
Loss: 0.0584
Fold 1 Epoch 031; Train loss: 0.0462; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0437; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1762; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0430; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0417; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1911; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0412; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0401; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1770; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0392; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0391; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1486; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0386; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0365; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 017; Train loss: 0.1817; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.440397   0.310697   0.607616   0.364379  
Loss: 0.0376
Fold 1 Epoch 041; Train loss: 0.0363; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0354; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1315; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0335; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0332; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1378; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0334; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0318; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1642; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.619205   0.527796   0.678808   0.547112   0.715232   0.556328  
Loss: 0.3297
Fold 1 Epoch 047; Train loss: 0.0307; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0303; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1496; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0281; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0273; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.500000   0.381700   0.668874   0.435823  
Loss: 0.0261
Fold 1 Epoch 022; Train loss: 0.1438; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0275; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0262; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1224; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0248; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0898; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0239; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0911; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0234; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0233; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0216; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1055; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0220; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.508278   0.372651   0.692053   0.431999  
Loss: 0.0219
Fold 1 Epoch 061; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1019; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0207; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1097; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0199; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1080; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0193; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0182; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1009; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.647351   0.582468   0.703642   0.600648   0.735099   0.608450  
Loss: 0.3003
Fold 1 Epoch 068; Train loss: 0.0178; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0176; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.0926; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0180; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.498344   0.387946   0.644040   0.433844  
Loss: 0.0175
Fold 1 Epoch 071; Train loss: 0.0170; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0855; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0168; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0165; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0718; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0152; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0150; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1018; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0147; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0150; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1073; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0143; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0141; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.630795   0.446223   0.758278   0.485972  
Loss: 0.0150
Fold 1 Epoch 036; Train loss: 0.0769; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0142; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0136; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1000; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0129; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0124; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0121; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0954; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0117; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0109; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.1319; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0103; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0098; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0709; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.698675   0.639908   0.728477   0.649468   0.764901   0.658944  
Loss: 0.2761
Fold 1 Epoch 090; Train loss: 0.0096; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.640728   0.474069   0.824503   0.532987  
Loss: 0.0109
Fold 1 Epoch 091; Train loss: 0.0096; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0800; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0095; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0095; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.1018; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0093; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0088; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0703; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0088; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0083; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0729; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0080; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0076; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0075; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 045; Train loss: 0.0479; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.655629   0.470099   0.850993   0.534303  
Loss: 0.0076
[timesteps candidate 100] Fold 1: HR@10 = [np.float64(0.695364238410596), np.float64(0.7251655629139073), np.float64(0.6970198675496688), np.float64(0.6076158940397351), np.float64(0.6688741721854304), np.float64(0.6920529801324503), np.float64(0.6440397350993378), np.float64(0.7582781456953642), np.float64(0.8245033112582781), np.float64(0.8509933774834437)]
Tuning timesteps:  20%|██        | 1/5 [02:04<08:19, 124.96s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6583; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2603; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0753; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1802; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1463; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1038; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1240; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1190; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0988; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1090; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1057; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.0987; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0623; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.0993; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.339404   0.252994   0.543046   0.317187  
Loss: 0.1200
Fold 1 Epoch 011; Train loss: 0.0993; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.1065; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.700331   0.644102   0.746689   0.659184   0.778146   0.667225  
Loss: 0.2687
Fold 1 Epoch 012; Train loss: 0.0949; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0903; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0544; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0881; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0869; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0607; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0840; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0821; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0736; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0803; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0786; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0419; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0754; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.548013   0.409037   0.728477   0.466450  
Loss: 0.0896
Fold 1 Epoch 021; Train loss: 0.0740; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0762; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0710; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0699; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0674; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0701; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0664; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0627; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0414; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0624; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0618; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0401; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0584; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0571; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.519868   0.388533   0.756623   0.464913  
Loss: 0.0656
Fold 1 Epoch 059; Train loss: 0.0664; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0549; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0523; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0353; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.750000   0.684922   0.771523   0.692108   0.791391   0.697063  
Loss: 0.2430
Fold 1 Epoch 033; Train loss: 0.0516; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0489; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0347; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0484; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0463; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0446; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0547; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0419; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0419; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0345; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0395; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.488411   0.366652   0.688742   0.431559  
Loss: 0.0471
Fold 1 Epoch 041; Train loss: 0.0391; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0636; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0360; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0357; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0900; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0338; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0331; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0498; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0328; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0304; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0893; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0284; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1085; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0281; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.596026   0.430150   0.811258   0.500302  
Loss: 0.0270
Fold 1 Epoch 051; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0784; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0265; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0462; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
Fold 1 Epoch 054; Train loss: 0.0249; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.750000   0.691274   0.769868   0.697678   0.789735   0.702605  
Loss: 0.2344
Fold 1 Epoch 055; Train loss: 0.0239; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0225; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0545; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0216; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0893; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0205; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0202; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.620861   0.451815   0.849338   0.527624  
Loss: 0.0190
Fold 1 Epoch 073; Train loss: 0.0501; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0180; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0185; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0597; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0170; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0165; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0477; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0157; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0156; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0602; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0154; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0141; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0136; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0763; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0131; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.437086   0.298171   0.746689   0.398019  
Loss: 0.0139
Fold 1 Epoch 071; Train loss: 0.0127; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0655; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0131; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0115; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0421; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0113; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0102; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0409; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.738411   0.689506   0.776490   0.701753   0.806291   0.709341  
Loss: 0.2343
Fold 1 Epoch 076; Train loss: 0.0101; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0093; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0474; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0087; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0082; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0076; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
Fold 1 Epoch 082; Train loss: 0.0527; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.412252   0.257055   0.735099   0.359284  
Loss: 0.0072
Fold 1 Epoch 081; Train loss: 0.0069; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0063; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0341; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0058; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0409; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0053; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0050; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0763; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0044; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0042; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0583; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0032; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.473510   0.283560   0.899007   0.425006  
Loss: 0.0030
Fold 1 Epoch 087; Train loss: 0.0487; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0027; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0022; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0429; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0019; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0013; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0452; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0253; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.759934   0.713130   0.783113   0.720757   0.809603   0.727466  
Loss: 0.2087
Fold 1 Epoch 098; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0529; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0004; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.324941   0.899007   0.444968  
Loss: 0.0006
[timesteps candidate 150] Fold 1: HR@10 = [np.float64(0.543046357615894), np.float64(0.7284768211920529), np.float64(0.7566225165562914), np.float64(0.6887417218543046), np.float64(0.8112582781456954), np.float64(0.8493377483443708), np.float64(0.7466887417218543), np.float64(0.7350993377483444), np.float64(0.8990066225165563), np.float64(0.8990066225165563)]
Tuning timesteps:  40%|████      | 2/5 [04:11<06:18, 126.11s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.7516; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0558; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.3132; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.2184; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0441; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1891; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1652; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0544; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1608; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1496; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1443; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0161; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1386; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1358; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.519868   0.394623   0.619205   0.426778  
Loss: 0.1533
Fold 1 Epoch 096; Train loss: 0.0490; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.1292; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1239; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0379; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.1219; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1221; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0284; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.1146; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1098; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0437; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.1118; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1021; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0985; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0604; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.761589   0.717840   0.783113   0.724963   0.798013   0.728758  
Loss: 0.2149
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.745033   0.700656   0.764901   0.707165   0.798013   0.715485  
Loss: 0.2250
Fold 1: Final Test Loss: 0.2250, HR@5: 0.7450
[optimizer candidate lamb] Fold 1: Loss = 0.2250
Tuning optimizer based on loss:  25%|██▌       | 1/4 [04:29<13:29, 269.71s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 020; Train loss: 0.0971; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.591060   0.477081   0.682119   0.506895  
Loss: 0.1153
Fold 1 Epoch 021; Train loss: 0.0960; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.5767; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0907; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5951; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0903; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0848; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4690; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0823; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0802; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4872; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0745; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0727; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3967; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0720; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0689; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 006; Train loss: 0.3898; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.609272   0.450902   0.716887   0.485925  
Loss: 0.0791
Fold 1 Epoch 031; Train loss: 0.0678; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.3415; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0641; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0619; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3411; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0606; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0576; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2794; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.0532; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0525; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2506; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.408940   0.329907   0.475166   0.351657   0.559603   0.372981  
Loss: 0.3866
Fold 1 Epoch 038; Train loss: 0.0490; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0480; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2379; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0446; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.637417   0.481902   0.753311   0.518356  
Loss: 0.0466
Fold 1 Epoch 041; Train loss: 0.0439; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2482; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0420; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0384; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2079; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0388; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0363; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.2246; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0329; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0313; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2007; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0304; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0286; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1595; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0272; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.614238   0.454071   0.743377   0.495350  
Loss: 0.0268
Fold 1 Epoch 017; Train loss: 0.2041; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0258; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0240; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1868; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0227; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0215; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1791; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0204; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0196; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1978; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.551325   0.462013   0.622517   0.484846   0.687086   0.501321  
Loss: 0.3115
Fold 1 Epoch 057; Train loss: 0.0193; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0177; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1314; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0167; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0159; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.619205   0.448330   0.741722   0.487860  
Loss: 0.0179
Fold 1 Epoch 022; Train loss: 0.1423; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0157; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0142; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1467; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0135; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0127; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1597; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0123; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0109; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1523; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0102; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0094; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1281; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0086; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0080; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.591060   0.417178   0.788079   0.480531  
Loss: 0.0075
Fold 1 Epoch 027; Train loss: 0.1292; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0072; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0064; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1373; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0057; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1125; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1227; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.625828   0.537173   0.685430   0.556873   0.735099   0.569726  
Loss: 0.2576
Fold 1 Epoch 077; Train loss: 0.0030; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0025; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.1235; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0020; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0016; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.409873   0.892384   0.515218  
Loss: 0.0017
Fold 1 Epoch 032; Train loss: 0.1131; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0013; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1189; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0988; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1000; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0761; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0002; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.411034   0.899007   0.525039  
Loss: 0.0005
Fold 1 Epoch 037; Train loss: 0.0895; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1074; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.1060; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0860; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.687086   0.583820   0.745033   0.602596   0.779801   0.611585  
Loss: 0.2298
Fold 1 Epoch 097; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0672; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 042; Train loss: 0.1221; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.379602   0.899007   0.493607  
Loss: 0.0003
[timesteps candidate 200] Fold 1: HR@10 = [np.float64(0.6192052980132451), np.float64(0.6821192052980133), np.float64(0.7168874172185431), np.float64(0.7533112582781457), np.float64(0.7433774834437086), np.float64(0.7417218543046358), np.float64(0.7880794701986755), np.float64(0.8923841059602649), np.float64(0.8990066225165563), np.float64(0.8990066225165563)]
Tuning timesteps:  60%|██████    | 3/5 [06:19<04:13, 126.70s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.7539; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.1069; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.3463; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.2674; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.1235; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.2185; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.2016; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0785; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1860; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1821; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0946; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1676; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1584; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1073; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.1540; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.584437   0.485386   0.690397   0.518789  
Loss: 0.1900
Fold 1 Epoch 011; Train loss: 0.1527; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0961; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.1450; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1403; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0861; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.1358; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1348; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0745; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.683775   0.590132   0.741722   0.608995   0.773179   0.617035  
Loss: 0.2275
Fold 1 Epoch 016; Train loss: 0.1259; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1179; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1130; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0869; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.1161; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1101; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
Fold 1 Epoch 052; Train loss: 0.0641; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.602649   0.501395   0.692053   0.530104  
Loss: 0.1373
Fold 1 Epoch 021; Train loss: 0.1037; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0965; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0998; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0964; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0918; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.1110; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0884; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0834; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0863; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0822; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0752; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.1055; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0758; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0726; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.614238   0.509359   0.706954   0.539343  
Loss: 0.0911
Fold 1 Epoch 057; Train loss: 0.0683; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0681; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0871; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0647; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0607; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0620; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0602; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0561; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0545; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.682119   0.605652   0.736755   0.623656   0.771523   0.632678  
Loss: 0.2239
Fold 1 Epoch 036; Train loss: 0.0534; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0502; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0506; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0489; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0450; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0436; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 062; Train loss: 0.0805; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.652318   0.514719   0.754967   0.547957  
Loss: 0.0536
Fold 1 Epoch 041; Train loss: 0.0404; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0631; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0376; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0348; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0793; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0321; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0300; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.1099; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0279; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0263; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0245; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0812; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0226; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0212; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 067; Train loss: 0.0880; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.639073   0.504565   0.743377   0.538404  
Loss: 0.0263
Fold 1 Epoch 051; Train loss: 0.0184; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0737; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0166; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0154; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.1032; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.0144; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0128; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0545; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
Fold 1 Epoch 056; Train loss: 0.0117; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.726821   0.640226   0.761589   0.651425   0.781457   0.656517  
Loss: 0.2019
Fold 1 Epoch 057; Train loss: 0.0112; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0108; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0512; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0093; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0081; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
Fold 1 Epoch 072; Train loss: 0.0573; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.599338   0.456288   0.925497   0.558176  
Loss: 0.0126
Fold 1 Epoch 061; Train loss: 0.0075; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0396; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0068; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0054; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.1031; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0050; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0393; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0037; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0030; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0876; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0025; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0022; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.436086   0.897351   0.550869  
Loss: 0.0045
Fold 1 Epoch 077; Train loss: 0.0570; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0019; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0017; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0487; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0972; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0595; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.736755   0.657824   0.773179   0.669810   0.799669   0.676439  
Loss: 0.1887
Fold 1 Epoch 077; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0730; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0005; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
Fold 1 Epoch 082; Train loss: 0.0820; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.436086   0.897351   0.555635  
Loss: 0.0016
Fold 1 Epoch 081; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0684; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0661; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0654; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0612; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0891; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0002; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.814570   0.537924   0.897351   0.563702  
Loss: 0.0007
Fold 1 Epoch 091; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0736; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0920; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0550; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.746689   0.664211   0.784768   0.676644   0.802980   0.681424  
Loss: 0.1888
Fold 1 Epoch 096; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0407; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 092; Train loss: 0.1053; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.436086   0.897351   0.555635  
Loss: 0.0005
[timesteps candidate 250] Fold 1: HR@10 = [np.float64(0.6903973509933775), np.float64(0.6920529801324503), np.float64(0.706953642384106), np.float64(0.7549668874172185), np.float64(0.7433774834437086), np.float64(0.9254966887417219), np.float64(0.8973509933774835), np.float64(0.8973509933774835), np.float64(0.8973509933774835), np.float64(0.8973509933774835)]
Tuning timesteps:  80%|████████  | 4/5 [08:27<02:07, 127.19s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.7573; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0672; Time: 00:00:03
Fold 1 Epoch 002; Train loss: 0.3649; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.2750; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0461; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.2481; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.2227; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0590; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.2103; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1927; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0505; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1926; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1788; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0559; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.1763; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.493377   0.424873   0.634106   0.470067  
Loss: 0.2061
Fold 1 Epoch 011; Train loss: 0.1629; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0659; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.1627; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1541; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0498; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.1461; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1451; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0595; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.741722   0.671278   0.778146   0.683436   0.796358   0.688032  
Loss: 0.1852
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.735099   0.659023   0.786424   0.675675   0.796358   0.678175  
Loss: 0.1860
Fold 1: Final Test Loss: 0.1860, HR@5: 0.7351
[optimizer candidate adamw] Fold 1: Loss = 0.1860
Tuning optimizer based on loss:  50%|█████     | 2/4 [08:41<08:38, 259.21s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 016; Train loss: 0.1328; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1273; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6132; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.1204; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1193; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5919; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.1137; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.523179   0.346501   0.652318   0.387564  
Loss: 0.1348
Fold 1 Epoch 021; Train loss: 0.1101; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5395; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.1071; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1004; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4809; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.0960; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3593; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0892; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0862; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.2785; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0810; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0765; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2445; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0737; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0706; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.414236   0.662252   0.448941  
Loss: 0.0809
Fold 1 Epoch 008; Train loss: 0.3186; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0661; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0618; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1536; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0587; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0559; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1670; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.528146   0.445785   0.599338   0.468519   0.644040   0.479650  
Loss: 0.4210
Fold 1 Epoch 035; Train loss: 0.0518; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0492; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.1909; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0465; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0433; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1115; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0404; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0381; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 013; Train loss: 0.1750; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.609272   0.440362   0.771523   0.492630  
Loss: 0.0435
Fold 1 Epoch 041; Train loss: 0.0359; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1645; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0337; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0303; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1318; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0283; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0258; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1148; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0215; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0940; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0187; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0169; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0148; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 018; Train loss: 0.1136; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.733444   0.510830   0.895695   0.563708  
Loss: 0.0169
Fold 1 Epoch 051; Train loss: 0.0129; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1343; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0110; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0097; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0758; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.678808   0.596316   0.730132   0.612910   0.754967   0.619205  
Loss: 0.3125
Fold 1 Epoch 054; Train loss: 0.0081; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0069; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.0734; Time: 00:00:02
Fold 1 Epoch 056; Train loss: 0.0057; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0863; Time: 00:00:02
Fold 1 Epoch 058; Train loss: 0.0040; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0034; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0740; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0028; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.814570   0.542418   0.902318   0.569874  
Loss: 0.0037
Fold 1 Epoch 061; Train loss: 0.0024; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0713; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0021; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0017; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1043; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0013; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0566; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1294; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0730; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0006; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.814570   0.512871   0.892384   0.538041  
Loss: 0.0011
Fold 1 Epoch 071; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0782; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0588; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.726821   0.646164   0.759934   0.657147   0.783113   0.663113  
Loss: 0.2714
Fold 1 Epoch 074; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.0490; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0912; Time: 00:00:03
Fold 1 Epoch 078; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0818; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0002; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.630795   0.410345   0.892384   0.500475  
Loss: 0.0005
Fold 1 Epoch 034; Train loss: 0.0779; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0739; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0621; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0503; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0535; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.378441   0.899007   0.498468  
Loss: 0.0003
Fold 1 Epoch 039; Train loss: 0.0478; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0348; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.736755   0.656377   0.773179   0.668126   0.789735   0.672393  
Loss: 0.2485
Fold 1 Epoch 093; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0329; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0592; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0459; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.314892   0.899007   0.434919  
Loss: 0.0002
[timesteps candidate 300] Fold 1: HR@10 = [np.float64(0.6341059602649006), np.float64(0.652317880794702), np.float64(0.6622516556291391), np.float64(0.7715231788079471), np.float64(0.8956953642384106), np.float64(0.902317880794702), np.float64(0.8923841059602649), np.float64(0.8923841059602649), np.float64(0.8990066225165563), np.float64(0.8990066225165563)]
Tuning timesteps: 100%|██████████| 5/5 [10:38<00:00, 128.57s/it]Tuning timesteps: 100%|██████████| 5/5 [10:38<00:00, 127.65s/it]

Best timesteps found: 150
Tuning dropout_rate:   0%|          | 0/5 [00:00<?, ?it/s]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 044; Train loss: 0.0219; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6921; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2547; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0579; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1804; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1603; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0425; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1347; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1279; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0769; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1180; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1142; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0557; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1079; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1032; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.448675   0.351204   0.564570   0.387702  
Loss: 0.1240
Fold 1 Epoch 049; Train loss: 0.0602; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.1002; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0998; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0422; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
Fold 1 Epoch 013; Train loss: 0.0981; Time: 00:00:010.746689   0.654275   0.771523   0.662420   0.798013   0.669169  
Loss: 0.2394

Fold 1 Epoch 014; Train loss: 0.0923; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0924; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0586; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0912; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0897; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0606; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0859; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0830; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0512; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0796; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.556291   0.461920   0.672185   0.498847  
Loss: 0.1050
Fold 1 Epoch 021; Train loss: 0.0798; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0478; Time: 00:00:03
Fold 1 Epoch 022; Train loss: 0.0782; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0750; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0740; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0341; Time: 00:00:03
Fold 1 Epoch 025; Train loss: 0.0709; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0703; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0800; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0698; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0665; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0641; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0645; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0646; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.501656   0.420411   0.610927   0.454728  
Loss: 0.0777
Fold 1 Epoch 058; Train loss: 0.0168; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0620; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0605; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0422; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0581; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0569; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0490; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.759934   0.682484   0.794702   0.693532   0.814570   0.698439  
Loss: 0.2167
Fold 1 Epoch 035; Train loss: 0.0560; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0522; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0419; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0520; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0507; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0457; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0469; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0462; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.571192   0.475376   0.672185   0.507553  
Loss: 0.0548
Fold 1 Epoch 063; Train loss: 0.0282; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0459; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0430; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0337; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0418; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0403; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0406; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0576; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0388; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0371; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0401; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0361; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0348; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0679; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0331; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.566225   0.473965   0.667219   0.506084  
Loss: 0.0380
Fold 1 Epoch 051; Train loss: 0.0325; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0378; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0306; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0301; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0383; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.0295; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0277; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0264; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0226; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.771523   0.708609   0.791391   0.715181   0.806291   0.719010  
Loss: 0.2110
Fold 1 Epoch 057; Train loss: 0.0254; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0247; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0354; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0234; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.541391   0.441444   0.677152   0.485269  
Loss: 0.0275
Fold 1 Epoch 072; Train loss: 0.0453; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0213; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0205; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0226; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0198; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0191; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0195; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0187; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0176; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0227; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0173; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0151; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0144; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0516; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0138; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.561258   0.447445   0.701987   0.492486  
Loss: 0.0161
Fold 1 Epoch 077; Train loss: 0.0536; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0119; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0110; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0374; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0106; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0101; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0276; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0095; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0088; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0236; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.759934   0.693734   0.788079   0.702839   0.807947   0.707895  
Loss: 0.2077
Fold 1 Epoch 078; Train loss: 0.0082; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0073; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0068; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
Fold 1 Epoch 081; Train loss: 0.0482; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.526490   0.408998   0.751656   0.480417  
Loss: 0.0082
Fold 1 Epoch 081; Train loss: 0.0065; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0056; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0338; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0053; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0048; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0545; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0039; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0519; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0030; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0024; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0328; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0022; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.536424   0.403518   0.899007   0.518453  
Loss: 0.0027
Fold 1 Epoch 086; Train loss: 0.0113; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0018; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0013; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0347; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0273; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0347; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0290; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
Fold 1 Epoch 100; Train loss: 0.0004; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.789735   0.733867   0.801325   0.737731   0.814570   0.741177  
Loss: 0.1902
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.436086   0.899007   0.550283  
Loss: 0.0006
[dropout_rate candidate 0.1] Fold 1: HR@10 = [np.float64(0.5645695364238411), np.float64(0.6721854304635762), np.float64(0.6109271523178808), np.float64(0.6721854304635762), np.float64(0.6672185430463576), np.float64(0.6771523178807947), np.float64(0.7019867549668874), np.float64(0.7516556291390728), np.float64(0.8990066225165563), np.float64(0.8990066225165563)]
Tuning dropout_rate:  20%|██        | 1/5 [02:07<08:31, 127.86s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.7247; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0370; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2713; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.2039; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1570; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0342; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1355; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1261; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0304; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1205; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1170; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0403; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1161; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1086; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.480132   0.403188   0.596026   0.440487  
Loss: 0.1368
Fold 1 Epoch 095; Train loss: 0.0461; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.1040; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1055; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0487; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.1000; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0995; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0935; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0231; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0906; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0899; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0161; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0911; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0871; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0458; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0849; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.589404   0.472805   0.725166   0.516637  
Loss: 0.1011
Fold 1 Epoch 021; Train loss: 0.0814; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0559; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.786424   0.723687   0.804636   0.729776   0.812914   0.731889  
Loss: 0.1996
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.779801   0.720769   0.804636   0.728827   0.814570   0.731325  
Loss: 0.2000
Fold 1: Final Test Loss: 0.2000, HR@5: 0.7798
[optimizer candidate radam] Fold 1: Loss = 0.2000
Tuning optimizer based on loss:  75%|███████▌  | 3/4 [13:06<04:21, 261.97s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 022; Train loss: 0.0827; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0783; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6022; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.0758; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0732; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.4853; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.0732; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0688; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0699; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4312; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0666; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0641; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.559603   0.459737   0.667219   0.494525  
Loss: 0.0731
Fold 1 Epoch 004; Train loss: 0.4328; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0627; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0609; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4075; Time: 00:00:03
Fold 1 Epoch 033; Train loss: 0.0612; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0589; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0572; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3240; Time: 00:00:03
Fold 1 Epoch 036; Train loss: 0.0564; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0548; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.4040; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0526; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0505; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2689; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0490; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.615894   0.484296   0.771523   0.534838  
Loss: 0.0537
Fold 1 Epoch 041; Train loss: 0.0463; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2320; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0452; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0438; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2023; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.460265   0.352479   0.538079   0.377828   0.592715   0.391683  
Loss: 0.3739
Fold 1 Epoch 044; Train loss: 0.0424; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0418; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0402; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.1695; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0388; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0380; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1895; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0377; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0353; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.534768   0.412131   0.700331   0.465938  
Loss: 0.0343
Fold 1 Epoch 013; Train loss: 0.1890; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0343; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0336; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1991; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0310; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0298; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2146; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0291; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0269; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2095; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0269; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0250; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0243; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1249; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0225; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.589404   0.408518   0.778146   0.469118  
Loss: 0.0232
Fold 1 Epoch 061; Train loss: 0.0222; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1377; Time: 00:00:03
Fold 1 Epoch 062; Train loss: 0.0206; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0203; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1601; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0196; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0181; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0178; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1608; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.604305   0.491624   0.677152   0.515347   0.736755   0.530842  
Loss: 0.3042
Fold 1 Epoch 067; Train loss: 0.0174; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0164; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.0589; Time: 00:00:03
Fold 1 Epoch 069; Train loss: 0.0164; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0151; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.495033   0.354084   0.764901   0.440282  
Loss: 0.0146
Fold 1 Epoch 022; Train loss: 0.1202; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0146; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0131; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1284; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0127; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0117; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1103; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0111; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0108; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1205; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0100; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0089; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1264; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0087; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.491722   0.299900   0.743377   0.379538  
Loss: 0.0080
Fold 1 Epoch 081; Train loss: 0.0080; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0668; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0071; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0068; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1452; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0071; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0060; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0808; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0056; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0826; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.705298   0.608960   0.746689   0.622593   0.791391   0.633922  
Loss: 0.2649
Fold 1 Epoch 089; Train loss: 0.0051; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0046; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.705298   0.394221   0.884106   0.453385  
Loss: 0.0040
Fold 1 Epoch 031; Train loss: 0.1023; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0040; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0035; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0853; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0031; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0027; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0608; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0023; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0019; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0707; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0010; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 035; Train loss: 0.0677; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.786424   0.417305   0.897351   0.452987  
Loss: 0.0008
[dropout_rate candidate 0.01] Fold 1: HR@10 = [np.float64(0.5960264900662252), np.float64(0.7251655629139073), np.float64(0.6672185430463576), np.float64(0.7715231788079471), np.float64(0.7003311258278145), np.float64(0.7781456953642384), np.float64(0.7649006622516556), np.float64(0.7433774834437086), np.float64(0.8841059602649006), np.float64(0.8973509933774835)]
Tuning dropout_rate:  40%|████      | 2/5 [04:15<06:23, 127.91s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6557; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2377; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0751; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1715; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1487; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0791; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1322; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1184; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0839; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1093; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1074; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1067; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0543; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.1025; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.455298   0.390062   0.579470   0.429707  
Loss: 0.1208
Fold 1 Epoch 011; Train loss: 0.0967; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0692; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.728477   0.627425   0.774834   0.643193   0.804636   0.650702  
Loss: 0.2529
Fold 1 Epoch 012; Train loss: 0.0959; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0915; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.0618; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0898; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0855; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0552; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0877; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0873; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0840; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0711; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0813; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0790; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.516556   0.435712   0.658940   0.480960  
Loss: 0.0927
Fold 1 Epoch 044; Train loss: 0.0417; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0770; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0716; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0570; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0701; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0700; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0626; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0675; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0660; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0645; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0837; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0621; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0607; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0396; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.0597; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.450331   0.385717   0.584437   0.428725  
Loss: 0.0718
Fold 1 Epoch 031; Train loss: 0.0569; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0464; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0553; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0535; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0808; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.778146   0.684766   0.802980   0.692949   0.816225   0.696315  
Loss: 0.2294
Fold 1 Epoch 034; Train loss: 0.0525; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0501; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0486; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0689; Time: 00:00:03
Fold 1 Epoch 037; Train loss: 0.0483; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0466; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0579; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0445; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0432; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.518212   0.395685   0.660596   0.441632  
Loss: 0.0490
Fold 1 Epoch 053; Train loss: 0.0682; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0409; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0402; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0392; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0406; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0367; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0361; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0706; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0343; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0338; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0516; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0325; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0315; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0302; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 057; Train loss: 0.0554; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.584437   0.429126   0.711921   0.471514  
Loss: 0.0326
Fold 1 Epoch 051; Train loss: 0.0291; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0274; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0481; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0268; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0314; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0258; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0255; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0632; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
Fold 1 Epoch 057; Train loss: 0.0231; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.784768   0.685604   0.802980   0.691649   0.817881   0.695387  
Loss: 0.2290
Fold 1 Epoch 058; Train loss: 0.0233; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0230; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0388; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0219; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.548013   0.403952   0.697020   0.452971  
Loss: 0.0215
Fold 1 Epoch 061; Train loss: 0.0216; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0436; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0203; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0194; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0368; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0183; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0175; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0527; Time: 00:00:03
Fold 1 Epoch 067; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0170; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0460; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0156; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0146; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.624172   0.410759   0.773179   0.458687  
Loss: 0.0146
Fold 1 Epoch 066; Train loss: 0.0477; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0125; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0359; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0114; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0106; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0098; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0245; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0091; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0085; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0504; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0082; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0073; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0632; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.776490   0.691759   0.806291   0.701665   0.819536   0.705090  
Loss: 0.2307
Fold 1 Epoch 080; Train loss: 0.0065; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.662252   0.420165   0.801325   0.464284  
Loss: 0.0066
Fold 1 Epoch 081; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0631; Time: 00:00:03
Fold 1 Epoch 082; Train loss: 0.0055; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0050; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0290; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0045; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0041; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0033; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0349; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0027; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0023; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0500; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0018; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0014; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.766556   0.448199   0.902318   0.492950  
Loss: 0.0014
Fold 1 Epoch 075; Train loss: 0.0390; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0187; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0278; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0285; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0435; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.324941   0.899007   0.445747  
Loss: 0.0002
[dropout_rate candidate 0.001] Fold 1: HR@10 = [np.float64(0.5794701986754967), np.float64(0.6589403973509934), np.float64(0.5844370860927153), np.float64(0.6605960264900662), np.float64(0.7119205298013245), np.float64(0.6970198675496688), np.float64(0.7731788079470199), np.float64(0.8013245033112583), np.float64(0.902317880794702), np.float64(0.8990066225165563)]
Tuning dropout_rate:  60%|██████    | 3/5 [06:22<04:15, 127.52s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6099; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0257; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.806291   0.729192   0.827815   0.736253   0.831126   0.737112  
Loss: 0.2182
Fold 1 Epoch 002; Train loss: 0.2317; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1598; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1438; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0248; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1165; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1109; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0484; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1082; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1020; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0232; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1011; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0959; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.533113   0.420534   0.710265   0.479109  
Loss: 0.1184
Fold 1 Epoch 084; Train loss: 0.0335; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.0934; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0917; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0280; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.0860; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0838; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0346; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0830; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0804; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0778; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0490; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0766; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0727; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0422; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0703; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.653974   0.516695   0.779801   0.557206  
Loss: 0.0852
Fold 1 Epoch 021; Train loss: 0.0734; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0227; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0687; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0665; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0382; Time: 00:00:03
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.779801   0.709785   0.814570   0.721537   0.822848   0.723645  
Loss: 0.2294
Fold 1 Epoch 024; Train loss: 0.0631; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0651; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.0491; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.0602; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0597; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0562; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0374; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0555; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0517; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.503311   0.390457   0.663907   0.441207  
Loss: 0.0645
Fold 1 Epoch 093; Train loss: 0.0489; Time: 00:00:03
Fold 1 Epoch 031; Train loss: 0.0511; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0495; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0321; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0471; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0460; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0446; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0415; Time: 00:00:02
Fold 1 Epoch 036; Train loss: 0.0436; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0411; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0276; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0393; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0376; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0179; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0367; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.576159   0.455203   0.768212   0.518004  
Loss: 0.0418
Fold 1 Epoch 041; Train loss: 0.0351; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0382; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0341; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0319; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0321; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0096; Time: 00:00:03
Fold 1 Epoch 045; Train loss: 0.0292; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0199; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.809603   0.736815   0.821192   0.740456   0.831126   0.743023  
Loss: 0.2169
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.794702   0.728958   0.814570   0.735636   0.824503   0.738168  
Loss: 0.2248
Fold 1: Final Test Loss: 0.2248, HR@5: 0.7947
[optimizer candidate adamp] Fold 1: Loss = 0.2248
Tuning optimizer based on loss: 100%|██████████| 4/4 [17:54<00:00, 271.97s/it]Tuning optimizer based on loss: 100%|██████████| 4/4 [17:54<00:00, 268.53s/it]

Best optimizer based on loss: adamw
Tuning data for optimizer (loss) saved to ./item/tuning_optimizer.json
Tuning timesteps based on loss:   0%|          | 0/5 [00:00<?, ?it/s]
========== Fold 1 ==========
3883
Fold 1 Epoch 047; Train loss: 0.0271; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0262; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.5952; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0245; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0238; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.682119   0.494404   0.809603   0.534899  
Loss: 0.0246
Fold 1 Epoch 002; Train loss: 0.5791; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0219; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0208; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5242; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0202; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0187; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4780; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0184; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0174; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4473; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0160; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0155; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.4086; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0145; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0138; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.491722   0.388296   0.769868   0.481637  
Loss: 0.0116
Fold 1 Epoch 007; Train loss: 0.2778; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0129; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0118; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2371; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0114; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0107; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2547; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0097; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0086; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2676; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.470199   0.376871   0.526490   0.395636   0.576159   0.408372  
Loss: 0.3747
Fold 1 Epoch 067; Train loss: 0.0082; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0078; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2175; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0069; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0062; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.536424   0.352420   0.806291   0.443466  
Loss: 0.0052
Fold 1 Epoch 012; Train loss: 0.2502; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0060; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0054; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2006; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0050; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1537; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0042; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2080; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0039; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0034; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1661; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0032; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0028; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1614; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0022; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.544702   0.297182   0.902318   0.415507  
Loss: 0.0017
Fold 1 Epoch 081; Train loss: 0.0017; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1832; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0013; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1672; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1776; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.607616   0.520171   0.652318   0.534677   0.708609   0.548949  
Loss: 0.3074
Fold 1 Epoch 086; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1649; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0002; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
Fold 1 Epoch 022; Train loss: 0.1824; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.314892   0.897351   0.428419  
Loss: 0.0003
Fold 1 Epoch 091; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1789; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1619; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1365; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0971; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1332; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.899007   0.430059  
Loss: 0.0001
[dropout_rate candidate 0.0001] Fold 1: HR@10 = [np.float64(0.7102649006622517), np.float64(0.7798013245033113), np.float64(0.6639072847682119), np.float64(0.7682119205298014), np.float64(0.8096026490066225), np.float64(0.7698675496688742), np.float64(0.8062913907284768), np.float64(0.902317880794702), np.float64(0.8973509933774835), np.float64(0.8990066225165563)]
Tuning dropout_rate:  80%|████████  | 4/5 [08:29<02:07, 127.23s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6285; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0958; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2311; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1736; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1592; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1339; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1225; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0834; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.658940   0.578514   0.703642   0.593188   0.754967   0.606199  
Loss: 0.2566
Fold 1 Epoch 006; Train loss: 0.1165; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1068; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.1007; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1021; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.0956; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1049; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.0966; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.557947   0.452215   0.680464   0.491733  
Loss: 0.1188
Fold 1 Epoch 011; Train loss: 0.0924; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1016; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.0898; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0884; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1313; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0867; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0827; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1155; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0802; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0779; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0879; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0764; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0740; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1008; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0708; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.557947   0.462614   0.657285   0.494371  
Loss: 0.0815
Fold 1 Epoch 021; Train loss: 0.0695; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1329; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0670; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0666; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.1461; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.0654; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0617; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1002; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.658940   0.582632   0.713576   0.600098   0.758278   0.611764  
Loss: 0.2486
Fold 1 Epoch 026; Train loss: 0.0620; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0580; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.1257; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0560; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0553; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0530; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 042; Train loss: 0.1118; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.498344   0.397693   0.630795   0.439935  
Loss: 0.0618
Fold 1 Epoch 031; Train loss: 0.0511; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0891; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0491; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0490; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0472; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.1060; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0460; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0421; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0461; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0430; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0397; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0808; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0376; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0372; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 047; Train loss: 0.0966; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.541391   0.441913   0.695364   0.491264  
Loss: 0.0371
Fold 1 Epoch 041; Train loss: 0.0350; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0515; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0343; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0329; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.1205; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0320; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0304; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0788; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.725166   0.646520   0.769868   0.660963   0.794702   0.667372  
Loss: 0.2119
Fold 1 Epoch 046; Train loss: 0.0303; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0279; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0962; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0264; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0261; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0253; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 052; Train loss: 0.0769; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.534768   0.387520   0.692053   0.437655  
Loss: 0.0247
Fold 1 Epoch 051; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0720; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0229; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0219; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0921; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.0208; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0195; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0190; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.1123; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0182; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0172; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0512; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0169; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0157; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.345144   0.700331   0.395598  
Loss: 0.0158
Fold 1 Epoch 057; Train loss: 0.0924; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0137; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0462; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0132; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0119; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0822; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0114; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0102; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0434; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.728477   0.649069   0.756623   0.658211   0.791391   0.666815  
Loss: 0.2169
Fold 1 Epoch 067; Train loss: 0.0096; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0094; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0956; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0090; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0080; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.567881   0.336888   0.683775   0.374775  
Loss: 0.0062
Fold 1 Epoch 062; Train loss: 0.0528; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0064; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0596; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0063; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0056; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0726; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0054; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0827; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0037; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0032; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0916; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0028; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.337110   0.899007   0.434537  
Loss: 0.0026
Fold 1 Epoch 081; Train loss: 0.0025; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0485; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0020; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0016; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0573; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0718; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0688; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.736755   0.657569   0.788079   0.674322   0.802980   0.678100  
Loss: 0.1976
Fold 1 Epoch 088; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.0345; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0002; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.900662   0.430728  
Loss: 0.0004
Fold 1 Epoch 091; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0793; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0925; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0608; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0526; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0563; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.895695   0.429293  
Loss: 0.0001
[dropout_rate candidate 1e-05] Fold 1: HR@10 = [np.float64(0.6804635761589404), np.float64(0.6572847682119205), np.float64(0.6307947019867549), np.float64(0.695364238410596), np.float64(0.6920529801324503), np.float64(0.7003311258278145), np.float64(0.6837748344370861), np.float64(0.8990066225165563), np.float64(0.9006622516556292), np.float64(0.8956953642384106)]
Tuning dropout_rate: 100%|██████████| 5/5 [10:36<00:00, 127.04s/it]Tuning dropout_rate: 100%|██████████| 5/5 [10:36<00:00, 127.27s/it]

Best dropout_rate found: 0.1
Tuning l2_decay:   0%|          | 0/5 [00:00<?, ?it/s]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6244; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0702; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2742; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.2080; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0506; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1873; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1806; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0529; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1727; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1652; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0664; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.756623   0.674566   0.784768   0.684003   0.809603   0.690145  
Loss: 0.1848
Fold 1 Epoch 008; Train loss: 0.1574; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1521; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1452; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
Fold 1 Epoch 081; Train loss: 0.1107; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.624172   0.469094   0.781457   0.518633  
Loss: 0.2064
Fold 1 Epoch 011; Train loss: 0.1387; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0410; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.1316; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1256; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1195; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0497; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.1136; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1079; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0286; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.1022; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0602; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0975; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0923; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0873; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
Fold 1 Epoch 086; Train loss: 0.0547; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.665563   0.489138   0.865894   0.554359  
Loss: 0.1055
Fold 1 Epoch 021; Train loss: 0.0821; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0517; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0776; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0732; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0688; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0510; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0647; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0606; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0446; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0563; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0529; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0435; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.754967   0.689110   0.783113   0.698298   0.804636   0.703780  
Loss: 0.1759
Fold 1 Epoch 029; Train loss: 0.0492; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0457; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.519868   0.419632   0.867550   0.527339  
Loss: 0.0505
Fold 1 Epoch 091; Train loss: 0.0506; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0425; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0394; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0436; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0368; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0340; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0376; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0315; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0291; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0524; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0271; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0250; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1102; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0231; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0213; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.519868   0.374379   0.867550   0.488587  
Loss: 0.0209
Fold 1 Epoch 096; Train loss: 0.0450; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0197; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0182; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0327; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0168; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0154; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0424; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0141; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0130; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0605; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0120; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0111; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0460; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.750000   0.683104   0.776490   0.691869   0.809603   0.700367  
Loss: 0.1780
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.754967   0.684961   0.784768   0.694915   0.799669   0.698638  
Loss: 0.1786
Fold 1: Final Test Loss: 0.1786, HR@5: 0.7550
[timesteps candidate 100] Fold 1: Loss = 0.1786
Tuning timesteps based on loss:  20%|██        | 1/5 [04:15<17:02, 255.71s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 049; Train loss: 0.0102; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0094; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.321192   0.298634   0.867550   0.474645  
Loss: 0.0082
Fold 1 Epoch 001; Train loss: 0.5986; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0086; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0079; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5909; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0073; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0067; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.6124; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0061; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0056; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5189; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0052; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0047; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4978; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0040; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
Fold 1 Epoch 006; Train loss: 0.4343; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.321192   0.167596   0.867550   0.347217  
Loss: 0.0030
Fold 1 Epoch 061; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.4217; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0033; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0031; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3831; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0028; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0026; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.3847; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0024; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0021; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.3028; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.326159   0.254438   0.389073   0.274884   0.470199   0.295218  
Loss: 0.4238
Fold 1 Epoch 068; Train loss: 0.0020; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0018; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2659; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0016; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.321192   0.177373   0.700331   0.300551  
Loss: 0.0011
Fold 1 Epoch 012; Train loss: 0.2829; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0014; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2515; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1944; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.3109; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2753; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0007; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.321192   0.163694   0.698675   0.286354  
Loss: 0.0004
Fold 1 Epoch 017; Train loss: 0.2277; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2691; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.2618; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2452; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.468543   0.383395   0.543046   0.407576   0.614238   0.425564  
Loss: 0.3389
Fold 1 Epoch 086; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.2264; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1947; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0003; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.322848   0.149758   0.670530   0.259413  
Loss: 0.0001
Fold 1 Epoch 023; Train loss: 0.1997; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1765; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1525; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.2238; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1866; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1671; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.322848   0.140987   0.667219   0.253149  
Loss: 0.0000
[l2_decay candidate 0.1] Fold 1: HR@10 = [np.float64(0.7814569536423841), np.float64(0.8658940397350994), np.float64(0.8675496688741722), np.float64(0.8675496688741722), np.float64(0.8675496688741722), np.float64(0.8675496688741722), np.float64(0.7003311258278145), np.float64(0.6986754966887417), np.float64(0.6705298013245033), np.float64(0.6672185430463576)]
Tuning l2_decay:  20%|██        | 1/5 [02:11<08:46, 131.73s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 029; Train loss: 0.1987; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.5920; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2261; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1582; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.554636   0.468127   0.607616   0.485989   0.652318   0.497264  
Loss: 0.3141
Fold 1 Epoch 003; Train loss: 0.1515; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1236; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.2007; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1079; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1031; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1615; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.0966; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.0887; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1742; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.0861; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0816; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
Fold 1 Epoch 034; Train loss: 0.1216; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.519868   0.390492   0.640728   0.429330  
Loss: 0.1125
Fold 1 Epoch 011; Train loss: 0.0787; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0745; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1549; Time: 00:00:03
Fold 1 Epoch 013; Train loss: 0.0704; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0658; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1331; Time: 00:00:03
Fold 1 Epoch 015; Train loss: 0.0626; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0607; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1659; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0577; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0563; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0860; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0512; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0501; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
Fold 1 Epoch 039; Train loss: 0.1199; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.419039   0.788079   0.495067  
Loss: 0.0691
Fold 1 Epoch 021; Train loss: 0.0469; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0450; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1336; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.572848   0.492971   0.653974   0.519089   0.708609   0.532992  
Loss: 0.2888
Fold 1 Epoch 023; Train loss: 0.0432; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0406; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.1128; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0386; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0365; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.1744; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0349; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0331; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.1588; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0313; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0292; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.473510   0.286974   0.629139   0.337236  
Loss: 0.0364
Fold 1 Epoch 044; Train loss: 0.1673; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0275; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0262; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0878; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0248; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0235; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.1549; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0217; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0207; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1609; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0192; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.1017; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0182; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0169; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.1136; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0163; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.347682   0.186481   0.627483   0.282511  
Loss: 0.0170
Fold 1 Epoch 050; Train loss: 0.0987; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.660596   0.571544   0.710265   0.587974   0.738411   0.594928  
Loss: 0.2529
Fold 1 Epoch 041; Train loss: 0.0147; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0139; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.1443; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0129; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0123; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.1014; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0115; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.1001; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0106; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0099; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.1400; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0092; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0085; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0796; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0079; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 056; Train loss: 0.0875; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.271973   0.657285   0.305848  
Loss: 0.0075
Fold 1 Epoch 051; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.1048; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0068; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.1177; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0064; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0058; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0715; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0055; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0051; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0797; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.668874   0.590643   0.700331   0.600708   0.750000   0.613394  
Loss: 0.2431
Fold 1 Epoch 057; Train loss: 0.0048; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0876; Time: 00:00:02
Fold 1 Epoch 058; Train loss: 0.0045; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0042; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.1125; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0039; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
Fold 1 Epoch 063; Train loss: 0.1115; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.264427   0.889073   0.365304  
Loss: 0.0031
Fold 1 Epoch 064; Train loss: 0.0777; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0645; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0033; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0031; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0924; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0029; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.1383; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0027; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1201; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0025; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0023; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.1187; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0021; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0672; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.680464   0.605671   0.711921   0.615768   0.756623   0.627356  
Loss: 0.2363
Fold 1 Epoch 069; Train loss: 0.0020; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0617; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0019; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
Fold 1 Epoch 072; Train loss: 0.1030; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.264427   0.889073   0.365304  
Loss: 0.0012
Fold 1 Epoch 073; Train loss: 0.0851; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0017; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0016; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0640; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0015; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.1217; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0013; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0919; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0012; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0671; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0011; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0892; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0010; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0764; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0009; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0447; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.700331   0.615788   0.738411   0.628234   0.761589   0.633971  
Loss: 0.2249
Fold 1 Epoch 080; Train loss: 0.0008; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
Fold 1 Epoch 081; Train loss: 0.1348; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.264427   0.889073   0.368117  
Loss: 0.0005
Fold 1 Epoch 081; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0577; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0007; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.1143; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.1406; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0006; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0717; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0005; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0523; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0005; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0891; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0004; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0004; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.1053; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0633; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0003; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
Fold 1 Epoch 090; Train loss: 0.0782; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.711921   0.625825   0.745033   0.636502   0.779801   0.645324  
Loss: 0.2236
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.271973   0.892384   0.376620  
Loss: 0.0002
Fold 1 Epoch 091; Train loss: 0.0637; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0003; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0003; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0744; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0002; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0837; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0002; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0860; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0002; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0649; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0002; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0817; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0002; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0554; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0829; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 099; Train loss: 0.0650; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.546358   0.264427   0.892384   0.369074  
Loss: 0.0001
[l2_decay candidate 0.01] Fold 1: HR@10 = [np.float64(0.640728476821192), np.float64(0.7880794701986755), np.float64(0.6291390728476821), np.float64(0.6274834437086093), np.float64(0.6572847682119205), np.float64(0.8890728476821192), np.float64(0.8890728476821192), np.float64(0.8890728476821192), np.float64(0.8923841059602649), np.float64(0.8923841059602649)]
Tuning l2_decay:  40%|████      | 2/5 [05:12<08:01, 160.41s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 100; Train loss: 0.0686; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 001; Train loss: 0.6712; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.705298   0.637535   0.726821   0.644562   0.751656   0.650923  
Loss: 0.2254
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.680464   0.611298   0.726821   0.626103   0.761589   0.635040  
Loss: 0.2322
Fold 1: Final Test Loss: 0.2322, HR@5: 0.6805
[timesteps candidate 150] Fold 1: Loss = 0.2322
Tuning timesteps based on loss:  40%|████      | 2/5 [08:27<12:40, 253.40s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 002; Train loss: 0.2584; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1840; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.5620; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1492; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5983; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1296; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1151; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5453; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1072; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1033; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5140; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.0977; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0928; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.581126   0.438694   0.716887   0.482449  
Loss: 0.1105
Fold 1 Epoch 005; Train loss: 0.4997; Time: 00:00:03
Fold 1 Epoch 011; Train loss: 0.0896; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0869; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.4569; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.0811; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0800; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.4165; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0750; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0722; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3655; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0718; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0676; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.3986; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0661; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0611; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.615894   0.477422   0.748344   0.519838  
Loss: 0.0756
Fold 1 Epoch 010; Train loss: 0.3211; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.291391   0.217752   0.369205   0.242965   0.428808   0.258006  
Loss: 0.4665
Fold 1 Epoch 021; Train loss: 0.0594; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0570; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.3111; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0546; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0514; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.3185; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0494; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0483; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.3358; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0453; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0430; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.3139; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0428; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0400; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.615894   0.494971   0.738411   0.533778  
Loss: 0.0461
Fold 1 Epoch 015; Train loss: 0.3300; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0371; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0357; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2587; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0336; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0326; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.3026; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0315; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0297; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2601; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0285; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.3117; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0252; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0247; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 020; Train loss: 0.2004; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.420530   0.347720   0.486755   0.368555   0.544702   0.383431  
Loss: 0.3851
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.431629   0.677152   0.471337  
Loss: 0.0260
Fold 1 Epoch 041; Train loss: 0.0231; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.2488; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0230; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0208; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.2102; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0208; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0192; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.2059; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0179; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0179; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0165; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.2393; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0154; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 025; Train loss: 0.2031; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.597682   0.393078   0.720199   0.432690  
Loss: 0.0155
Fold 1 Epoch 051; Train loss: 0.0142; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0134; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.2412; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0132; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0119; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.2076; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0113; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0106; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1957; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0101; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1838; Time: 00:00:02
Fold 1 Epoch 058; Train loss: 0.0094; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0090; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.2323; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 060; Train loss: 0.0082; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.478477   0.393487   0.543046   0.414272   0.591060   0.426334  
Loss: 0.3561
HR@5       NDCG@5     HR@10      NDCG@10   
0.614238   0.370643   0.761589   0.418573  
Loss: 0.0073
Fold 1 Epoch 061; Train loss: 0.0076; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.2660; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0073; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0066; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1642; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0063; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0060; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.2088; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0054; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0052; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1854; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0046; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1576; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0043; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.561258   0.313975   0.716887   0.362755  
Loss: 0.0034
Fold 1 Epoch 071; Train loss: 0.0041; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1670; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0038; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0035; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1934; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0032; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1613; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0030; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0029; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.2203; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0026; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0024; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1988; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.508278   0.438091   0.569536   0.458028   0.642384   0.476864  
Loss: 0.3324
Fold 1 Epoch 080; Train loss: 0.0023; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.315505   0.644040   0.344809  
Loss: 0.0020
Fold 1 Epoch 081; Train loss: 0.0022; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.1997; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0020; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.1678; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0019; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0017; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.1719; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0016; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.1750; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0014; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.2239; Time: 00:00:03
Fold 1 Epoch 089; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0010; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.894040   0.420899  
Loss: 0.0008
Fold 1 Epoch 046; Train loss: 0.1339; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1507; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.1889; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.1830; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.1236; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.564570   0.480182   0.614238   0.496581   0.655629   0.507059  
Loss: 0.3200
Fold 1 Epoch 098; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.1052; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0004; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.892384   0.434128  
Loss: 0.0003
[l2_decay candidate 0.001] Fold 1: HR@10 = [np.float64(0.7168874172185431), np.float64(0.7483443708609272), np.float64(0.7384105960264901), np.float64(0.6771523178807947), np.float64(0.7201986754966887), np.float64(0.7615894039735099), np.float64(0.7168874172185431), np.float64(0.6440397350993378), np.float64(0.8940397350993378), np.float64(0.8923841059602649)]
Tuning l2_decay:  60%|██████    | 3/5 [07:24<04:54, 147.42s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 052; Train loss: 0.1547; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6194; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2514; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.1940; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1757; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1403; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.1614; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1243; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1141; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1098; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.1724; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1039; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1040; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0722; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.0940; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.599338   0.470659   0.736755   0.514842  
Loss: 0.1168
Fold 1 Epoch 057; Train loss: 0.1286; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.0927; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.0896; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.1611; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.0873; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0872; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.1233; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0811; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0806; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.1816; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.572848   0.498101   0.615894   0.512068   0.653974   0.521637  
Loss: 0.3107
Fold 1 Epoch 017; Train loss: 0.0796; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0769; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0773; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0774; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0734; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.463703   0.713576   0.505581  
Loss: 0.0876
Fold 1 Epoch 062; Train loss: 0.1328; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0715; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0679; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.1233; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0634; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0625; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.1304; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0622; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0601; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.1488; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0567; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0542; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.1431; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0547; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0509; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.567881   0.455256   0.688742   0.494554  
Loss: 0.0594
Fold 1 Epoch 067; Train loss: 0.0819; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0485; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0475; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1467; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0444; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0442; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.1116; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0426; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0406; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.1215; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.582781   0.509954   0.624172   0.523543   0.682119   0.538356  
Loss: 0.2955
Fold 1 Epoch 037; Train loss: 0.0393; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0379; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.1433; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0374; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0349; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.609272   0.481815   0.710265   0.513500  
Loss: 0.0435
Fold 1 Epoch 072; Train loss: 0.1063; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0344; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0318; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.1074; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0308; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0302; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.1202; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0280; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0275; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0248; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.1548; Time: 00:00:03
Fold 1 Epoch 048; Train loss: 0.0248; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0226; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.1242; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0232; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.600993   0.470640   0.745033   0.516937  
Loss: 0.0236
Fold 1 Epoch 077; Train loss: 0.1436; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0215; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0203; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0674; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0192; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0185; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.1015; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0173; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0149; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.1009; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.624172   0.546516   0.668874   0.560727   0.703642   0.569490  
Loss: 0.2895
Fold 1 Epoch 058; Train loss: 0.0134; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0124; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0857; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0112; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.635762   0.485336   0.821192   0.543939  
Loss: 0.0130
Fold 1 Epoch 061; Train loss: 0.0104; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1335; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0097; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0082; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.1207; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0066; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.1018; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0055; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0047; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.1457; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0040; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0032; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.1109; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0027; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.423203   0.897351   0.522038  
Loss: 0.0034
Fold 1 Epoch 071; Train loss: 0.0021; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.1513; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0017; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0014; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0999; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0843; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0716; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.607616   0.536769   0.665563   0.555662   0.700331   0.564500  
Loss: 0.2788
Fold 1 Epoch 078; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.1276; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0003; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.411034   0.897351   0.527965  
Loss: 0.0006
Fold 1 Epoch 081; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0980; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0799; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0846; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1082; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.1129; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.814570   0.512871   0.897351   0.539402  
Loss: 0.0002
Fold 1 Epoch 091; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0866; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.1324; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.1137; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1000; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.635762   0.572401   0.678808   0.586713   0.705298   0.593549  
Loss: 0.2749
Fold 1: Final Test Phase
Fold 1 Epoch 098; Train loss: 0.0001; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.637417   0.577880   0.678808   0.591486   0.723510   0.602648  
Loss: 0.2622
Fold 1: Final Test Loss: 0.2622, HR@5: 0.6374
[timesteps candidate 200] Fold 1: Loss = 0.2622
Tuning timesteps based on loss:  60%|██████    | 3/5 [12:43<08:29, 254.76s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 099; Train loss: 0.0001; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0001; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
Fold 1 Epoch 001; Train loss: 0.5997; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.814570   0.512871   0.897351   0.538840  
Loss: 0.0001
[l2_decay candidate 0.0001] Fold 1: HR@10 = [np.float64(0.7367549668874173), np.float64(0.7135761589403974), np.float64(0.6887417218543046), np.float64(0.7102649006622517), np.float64(0.7450331125827815), np.float64(0.8211920529801324), np.float64(0.8973509933774835), np.float64(0.8973509933774835), np.float64(0.8973509933774835), np.float64(0.8973509933774835)]
Tuning l2_decay:  80%|████████  | 4/5 [09:32<02:19, 139.96s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.5869; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5745; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2314; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1642; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5776; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1366; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1217; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4900; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1143; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1079; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4939; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1057; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1006; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.4246; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.0968; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.600993   0.471381   0.774834   0.527436  
Loss: 0.1229
Fold 1 Epoch 011; Train loss: 0.0949; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.4400; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.0910; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0894; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.4332; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0900; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.4537; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0859; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0823; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.4147; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.261589   0.198902   0.299669   0.211228   0.349338   0.223837  
Loss: 0.4844
Fold 1 Epoch 017; Train loss: 0.0822; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0823; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.4007; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0794; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0778; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.423841   0.313644   0.586093   0.365098  
Loss: 0.0881
Fold 1 Epoch 012; Train loss: 0.3835; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0748; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0733; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.3368; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0712; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0704; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.3451; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0687; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.3122; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.0647; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0643; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2567; Time: 00:00:02
Fold 1 Epoch 028; Train loss: 0.0631; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0608; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.3393; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.0587; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.465232   0.337476   0.660596   0.401086  
Loss: 0.0694
Fold 1 Epoch 031; Train loss: 0.0558; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2570; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0555; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0536; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.2024; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0511; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0502; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2949; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.319536   0.240147   0.377483   0.259054   0.435430   0.273765  
Loss: 0.4539
Fold 1 Epoch 036; Train loss: 0.0481; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0471; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.2804; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0454; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0432; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.2543; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0421; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.569536   0.436574   0.706954   0.480471  
Loss: 0.0472
Fold 1 Epoch 023; Train loss: 0.2050; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0395; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0415; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.2964; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0369; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0356; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.2751; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0347; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0329; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.2370; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0321; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0298; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.2263; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0292; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0284; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.456954   0.335118   0.650662   0.397152  
Loss: 0.0308
Fold 1 Epoch 028; Train loss: 0.2579; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0273; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0256; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.2113; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0244; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.2414; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.400662   0.329248   0.456954   0.347315   0.519868   0.363442  
Loss: 0.3904
Fold 1 Epoch 055; Train loss: 0.0224; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0209; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.2484; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0203; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0198; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.2440; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0189; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0176; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.567881   0.403088   0.763245   0.466029  
Loss: 0.0185
Fold 1 Epoch 033; Train loss: 0.2548; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0163; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0161; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1953; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0143; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0136; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1918; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0128; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0125; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.2125; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0112; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0101; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.2333; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0098; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.2304; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0089; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.461921   0.300689   0.831126   0.420511  
Loss: 0.0082
Fold 1 Epoch 071; Train loss: 0.0077; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.2029; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0075; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1815; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.422185   0.346273   0.496689   0.369997   0.549669   0.383493  
Loss: 0.3826
Fold 1 Epoch 074; Train loss: 0.0081; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0072; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.1693; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0054; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0045; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.1753; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0040; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.2018; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0034; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.524834   0.273727   0.847682   0.377935  
Loss: 0.0031
Fold 1 Epoch 081; Train loss: 0.0029; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.1794; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0027; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0022; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.2822; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0019; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0016; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.2297; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0015; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1544; Time: 00:00:03
Fold 1 Epoch 088; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.1783; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0008; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.526490   0.256623   0.844371   0.357626  
Loss: 0.0008
Fold 1 Epoch 091; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.2099; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.1917; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.453642   0.382511   0.509934   0.400429   0.564570   0.414302  
Loss: 0.3804
Fold 1 Epoch 094; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.2159; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.1620; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.1999; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0005; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.526490   0.252033   0.880795   0.374192  
Loss: 0.0006
[l2_decay candidate 1e-05] Fold 1: HR@10 = [np.float64(0.7748344370860927), np.float64(0.5860927152317881), np.float64(0.6605960264900662), np.float64(0.706953642384106), np.float64(0.6506622516556292), np.float64(0.7632450331125827), np.float64(0.8311258278145696), np.float64(0.847682119205298), np.float64(0.8443708609271523), np.float64(0.8807947019867549)]
Tuning l2_decay: 100%|██████████| 5/5 [11:42<00:00, 136.28s/it]Tuning l2_decay: 100%|██████████| 5/5 [11:42<00:00, 140.49s/it]

Best l2_decay found: 0.0001
Tuning eps:   0%|          | 0/5 [00:00<?, ?it/s]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 054; Train loss: 0.1893; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.9604; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.7199; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.2243; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.5763; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4830; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.1556; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.4199; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3749; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.2067; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.3406; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3195; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.1662; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.2971; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2780; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.536424   0.415931   0.706954   0.470153  
Loss: 0.4058
Fold 1 Epoch 059; Train loss: 0.1833; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.2633; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2575; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.1494; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.486755   0.415681   0.531457   0.430268   0.577815   0.441803  
Loss: 0.3611
Fold 1 Epoch 013; Train loss: 0.2464; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.2437; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.2150; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.2317; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2255; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.1511; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.2211; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2117; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.1433; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.2097; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2040; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.561258   0.442428   0.718543   0.491838  
Loss: 0.3011
Fold 1 Epoch 064; Train loss: 0.2291; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.2030; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1987; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.1597; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.1915; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1890; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.1466; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.1882; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1868; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.1643; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.1839; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1786; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1786; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.1804; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1749; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.561258   0.456559   0.725166   0.508710  
Loss: 0.2490
Fold 1 Epoch 069; Train loss: 0.1551; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.1745; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1723; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0954; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.500000   0.426163   0.559603   0.445757   0.607616   0.457842  
Loss: 0.3359
Fold 1 Epoch 033; Train loss: 0.1689; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1654; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.1716; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.1679; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1636; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.2201; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.1616; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1591; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.1714; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.1578; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1591; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.604305   0.487462   0.735099   0.528611  
Loss: 0.2196
Fold 1 Epoch 074; Train loss: 0.1408; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.1559; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.1536; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.1587; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.1569; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.1538; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.1564; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.1530; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.1489; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.1612; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.1473; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.1478; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.1587; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.1469; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.1471; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.594371   0.476624   0.726821   0.518303  
Loss: 0.1927
Fold 1 Epoch 079; Train loss: 0.1234; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.1450; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.1422; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.1379; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.528146   0.457696   0.591060   0.478534   0.630795   0.488651  
Loss: 0.3237
Fold 1 Epoch 053; Train loss: 0.1426; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.1429; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.1905; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.1396; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.1418; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1599; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.1410; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.1407; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.1688; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.1422; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.1373; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.624172   0.495907   0.756623   0.538234  
Loss: 0.1803
Fold 1 Epoch 084; Train loss: 0.1564; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.1414; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.1367; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.1413; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.1350; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.1320; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.1847; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.1356; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.1361; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.1173; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.1356; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1334; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.2075; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.1310; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.1308; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.597682   0.490470   0.731788   0.533569  
Loss: 0.1695
Fold 1 Epoch 089; Train loss: 0.1215; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.1322; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.1309; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0996; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.541391   0.475299   0.602649   0.495287   0.653974   0.508264  
Loss: 0.3152
Fold 1 Epoch 073; Train loss: 0.1308; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.1284; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.1363; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.1292; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.1284; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.1301; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.1511; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.1261; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.1265; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.1337; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.1284; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.609272   0.488147   0.768212   0.539204  
Loss: 0.1558
Fold 1 Epoch 094; Train loss: 0.1215; Time: 00:00:03
Fold 1 Epoch 081; Train loss: 0.1264; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1265; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.1272; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1723; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.1256; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.1252; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0991; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.1255; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.1248; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.1561; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.1242; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.1236; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.1798; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.1244; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.615894   0.500126   0.751656   0.543919  
Loss: 0.1559
Fold 1 Epoch 099; Train loss: 0.1446; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.1224; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.1239; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1739; Time: 00:00:02Fold 1 Epoch 093; Train loss: 0.1241; Time: 00:00:01

Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.556291   0.469227   0.612583   0.487714   0.652318   0.497887  
Loss: 0.3093
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.548013   0.471043   0.602649   0.489066   0.644040   0.499550  
Loss: 0.3277
Fold 1: Final Test Loss: 0.3277, HR@5: 0.5480
[timesteps candidate 250] Fold 1: Loss = 0.3277
Tuning timesteps based on loss:  80%|████████  | 4/5 [16:57<04:14, 254.40s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 094; Train loss: 0.1243; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1207; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6266; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.1213; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.6089; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.1189; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.1207; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5152; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.1199; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1206; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.642384   0.511920   0.771523   0.553115  
Loss: 0.1564
[eps candidate 0.1] Fold 1: HR@10 = [np.float64(0.706953642384106), np.float64(0.7185430463576159), np.float64(0.7251655629139073), np.float64(0.7350993377483444), np.float64(0.7268211920529801), np.float64(0.7566225165562914), np.float64(0.7317880794701986), np.float64(0.7682119205298014), np.float64(0.7516556291390728), np.float64(0.7715231788079471)]
Tuning eps:  20%|██        | 1/5 [02:10<08:41, 130.31s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 004; Train loss: 0.5126; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6968; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.3803; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.5175; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.2719; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.2203; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.5021; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1913; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1768; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.4755; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1591; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.5031; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1547; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1416; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.4561; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.1437; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.617550   0.475988   0.743377   0.516287  
Loss: 0.1744
Fold 1 Epoch 011; Train loss: 0.1345; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.3811; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.201987   0.157222   0.248344   0.172307   0.299669   0.185338  
Loss: 0.5089
Fold 1 Epoch 012; Train loss: 0.1310; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1306; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.4608; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.1307; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1269; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.3645; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.1255; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1234; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.3438; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.1230; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1194; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.3955; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.1175; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.576159   0.467039   0.725166   0.514992  
Loss: 0.1346
Fold 1 Epoch 015; Train loss: 0.3693; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.1163; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1155; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.3587; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.1137; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1162; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.3926; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.1122; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1137; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.3528; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.1134; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1165; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.2883; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.1138; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1111; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 020; Train loss: 0.3269; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.526490   0.417323   0.670530   0.463692  
Loss: 0.1429
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.240066   0.190557   0.321192   0.216752   0.384106   0.232558  
Loss: 0.4877
Fold 1 Epoch 031; Train loss: 0.1121; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1125; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.3311; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.1125; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1093; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.2988; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.1131; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1103; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.2813; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.1130; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1091; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.3421; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.1112; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1088; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 025; Train loss: 0.3506; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.566225   0.450285   0.692053   0.490368  
Loss: 0.1314
Fold 1 Epoch 041; Train loss: 0.1072; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.3092; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.1054; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.1078; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.2514; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.1084; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.1093; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.2676; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.1051; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1042; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.3211; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.1080; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.1090; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.3045; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.311258   0.253883   0.372517   0.273835   0.418874   0.285399  
Loss: 0.4583
Fold 1 Epoch 050; Train loss: 0.1069; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.594371   0.478184   0.728477   0.521046  
Loss: 0.1362
Fold 1 Epoch 051; Train loss: 0.1068; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.2593; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.1058; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.1049; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.2995; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.1049; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.1036; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.3124; Time: 00:00:02
Fold 1 Epoch 056; Train loss: 0.1025; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.1024; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.2334; Time: 00:00:02
Fold 1 Epoch 058; Train loss: 0.1018; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.1035; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.2952; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.1051; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.433886   0.665563   0.472953  
Loss: 0.1322
Fold 1 Epoch 061; Train loss: 0.1063; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.3012; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.1027; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.1051; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.2494; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.1023; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.1033; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.2662; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.1000; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.1045; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1029; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.2660; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0997; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.1020; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
Fold 1 Epoch 040; Train loss: 0.1867; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.605960   0.483644   0.746689   0.528296  
Loss: 0.1374
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.364238   0.302804   0.417219   0.320023   0.465232   0.332483  
Loss: 0.4304
Fold 1 Epoch 071; Train loss: 0.1028; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.1032; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.3023; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.1019; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.1001; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.2509; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.1004; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0991; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.2816; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.1023; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.1009; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.2505; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0990; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.1024; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.574503   0.453135   0.725166   0.501559  
Loss: 0.1242
Fold 1 Epoch 045; Train loss: 0.2920; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.1004; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1016; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.2303; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.1003; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.1002; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.2551; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0997; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0982; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.2279; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0973; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.1006; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.2162; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0992; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0992; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
Fold 1 Epoch 050; Train loss: 0.2076; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.607616   0.481912   0.720199   0.518531  
Loss: 0.1278
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.380795   0.317360   0.435430   0.335175   0.493377   0.349901  
Loss: 0.4053
Fold 1 Epoch 091; Train loss: 0.1003; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.2330; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.1024; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.1007; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.2197; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.1019; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0996; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.1849; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0989; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0998; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.2432; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0985; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0983; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.2303; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0968; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.566225   0.460367   0.733444   0.513705  
Loss: 0.1263
[eps candidate 0.01] Fold 1: HR@10 = [np.float64(0.7433774834437086), np.float64(0.7251655629139073), np.float64(0.6705298013245033), np.float64(0.6920529801324503), np.float64(0.7284768211920529), np.float64(0.6655629139072847), np.float64(0.7466887417218543), np.float64(0.7251655629139073), np.float64(0.7201986754966887), np.float64(0.7334437086092715)]
Tuning eps:  40%|████      | 2/5 [04:16<06:23, 127.97s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.5883; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.2275; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2517; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1785; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.1973; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1520; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1349; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1207; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.2140; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1178; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.1149; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.2318; Time: 00:00:02
Fold 1 Epoch 009; Train loss: 0.1086; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1093; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.461921   0.383602   0.592715   0.425810  
Loss: 0.1355
Fold 1 Epoch 060; Train loss: 0.1243; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.422185   0.353409   0.483444   0.373188   0.544702   0.388451  
Loss: 0.3831
Fold 1 Epoch 011; Train loss: 0.1049; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1019; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.2431; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.1035; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0972; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.2557; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0995; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0946; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.2011; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0968; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0942; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.1993; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0935; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0960; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.599338   0.479672   0.743377   0.526004  
Loss: 0.1193
Fold 1 Epoch 065; Train loss: 0.2116; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0905; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0907; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.2305; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0918; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0891; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.2552; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0869; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0859; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.2147; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0845; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0874; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.1968; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0868; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0843; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.431463   0.731788   0.489704  
Loss: 0.1051
Fold 1 Epoch 070; Train loss: 0.2053; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.432119   0.357668   0.490066   0.376700   0.538079   0.388817  
Loss: 0.3788
Fold 1 Epoch 031; Train loss: 0.0842; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0808; Time: 00:00:01
Fold 1 Epoch 071; Train loss: 0.2080; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0802; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0807; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.1846; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0789; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0775; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.2171; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0772; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0771; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.2129; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0749; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0745; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
Fold 1 Epoch 075; Train loss: 0.2022; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.650662   0.521729   0.789735   0.566708  
Loss: 0.0895
Fold 1 Epoch 041; Train loss: 0.0744; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0746; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.2057; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0717; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0704; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.2193; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0690; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0672; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.1518; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0684; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0666; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.2292; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0652; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0676; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.624172   0.494087   0.786424   0.546571  
Loss: 0.0853
Fold 1 Epoch 080; Train loss: 0.1235; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.453642   0.387092   0.500000   0.402399   0.548013   0.414671  
Loss: 0.3749
Fold 1 Epoch 051; Train loss: 0.0654; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0640; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.1703; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0635; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0622; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1730; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0597; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0593; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.1489; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0589; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0593; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.1156; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0573; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0556; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.574503   0.473909   0.720199   0.520789  
Loss: 0.0742
Fold 1 Epoch 085; Train loss: 0.2021; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0554; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0550; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.1691; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0547; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0537; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.2292; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0529; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0517; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.1456; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0496; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0486; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.1841; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0492; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0475; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.552980   0.449019   0.741722   0.508979  
Loss: 0.0565
Fold 1 Epoch 090; Train loss: 0.2370; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.448675   0.381491   0.509934   0.401008   0.562914   0.414516  
Loss: 0.3714
Fold 1 Epoch 071; Train loss: 0.0472; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0461; Time: 00:00:01
Fold 1 Epoch 091; Train loss: 0.1629; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0456; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0444; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.1670; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0432; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0423; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0414; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.1843; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0405; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0397; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.1363; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0386; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.586093   0.486724   0.753311   0.539593  
Loss: 0.0504
Fold 1 Epoch 081; Train loss: 0.0376; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1553; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0367; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.1742; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0366; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0353; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0347; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.2033; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0331; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0335; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.1918; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0317; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0310; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.2117; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0297; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.584437   0.456707   0.758278   0.511613  
Loss: 0.0371
Fold 1 Epoch 091; Train loss: 0.0288; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1888; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.490066   0.408092   0.543046   0.425343   0.587748   0.436743  
Loss: 0.3527
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.483444   0.420084   0.533113   0.435940   0.584437   0.449117  
Loss: 0.3598
Fold 1: Final Test Loss: 0.3598, HR@5: 0.4834
[timesteps candidate 300] Fold 1: Loss = 0.3598
Tuning timesteps based on loss: 100%|██████████| 5/5 [21:09<00:00, 253.29s/it]Tuning timesteps based on loss: 100%|██████████| 5/5 [21:09<00:00, 253.81s/it]

Best timesteps based on loss: 100
Tuning data for timesteps (loss) saved to ./item/tuning_timesteps.json
Tuning dropout_rate based on loss:   0%|          | 0/4 [00:00<?, ?it/s]
========== Fold 1 ==========
3883
Fold 1 Epoch 092; Train loss: 0.0282; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6327; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0259; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0253; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5653; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0244; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0235; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5413; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0224; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0217; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4317; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0210; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.667219   0.468307   0.824503   0.518978  
Loss: 0.0291
[eps candidate 0.001] Fold 1: HR@10 = [np.float64(0.5927152317880795), np.float64(0.7433774834437086), np.float64(0.7317880794701986), np.float64(0.7897350993377483), np.float64(0.7864238410596026), np.float64(0.7201986754966887), np.float64(0.7417218543046358), np.float64(0.7533112582781457), np.float64(0.7582781456953642), np.float64(0.8245033112582781)]
Tuning eps:  60%|██████    | 3/5 [06:23<04:14, 127.35s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6611; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3698; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2567; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1797; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3505; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1474; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1281; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.3846; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1199; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1163; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2800; Time: 00:00:02
Fold 1 Epoch 008; Train loss: 0.1122; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1071; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2826; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.1050; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.605960   0.490468   0.735099   0.531980  
Loss: 0.1235
Fold 1 Epoch 011; Train loss: 0.0982; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2069; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.420530   0.326196   0.514901   0.356469   0.571192   0.370797  
Loss: 0.3640
Fold 1 Epoch 012; Train loss: 0.0945; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0958; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2305; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0947; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0918; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1974; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0867; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0838; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1773; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0786; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1755; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0781; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0774; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.465795   0.682119   0.498372  
Loss: 0.0995
Fold 1 Epoch 015; Train loss: 0.1505; Time: 00:00:02
Fold 1 Epoch 021; Train loss: 0.0754; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0739; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1781; Time: 00:00:02
Fold 1 Epoch 023; Train loss: 0.0716; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0682; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1618; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0685; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0651; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1767; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0638; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0628; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1470; Time: 00:00:02
Fold 1 Epoch 029; Train loss: 0.0608; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0582; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
Fold 1 Epoch 020; Train loss: 0.1796; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.678808   0.519946   0.781457   0.553068  
Loss: 0.0706
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.600993   0.507815   0.657285   0.525756   0.708609   0.538854  
Loss: 0.2752
Fold 1 Epoch 031; Train loss: 0.0556; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1286; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0551; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0532; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1815; Time: 00:00:02
Fold 1 Epoch 034; Train loss: 0.0511; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0495; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0468; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1376; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0451; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1704; Time: 00:00:02
Fold 1 Epoch 038; Train loss: 0.0444; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0428; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1615; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.0414; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.514901   0.403980   0.716887   0.468827  
Loss: 0.0507
Fold 1 Epoch 041; Train loss: 0.0402; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0911; Time: 00:00:02
Fold 1 Epoch 042; Train loss: 0.0383; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0384; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1026; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0355; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0350; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1381; Time: 00:00:02
Fold 1 Epoch 046; Train loss: 0.0337; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0314; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0770; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0313; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0298; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1289; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.650662   0.568318   0.685430   0.579853   0.740066   0.593808  
Loss: 0.2555
Fold 1 Epoch 050; Train loss: 0.0276; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.569536   0.445364   0.763245   0.508843  
Loss: 0.0344
Fold 1 Epoch 051; Train loss: 0.0276; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.1397; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0266; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1509; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0263; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0248; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0784; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0243; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0227; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1167; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0211; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0207; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0206; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0574; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0205; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.480132   0.347901   0.774834   0.445890  
Loss: 0.0226
Fold 1 Epoch 036; Train loss: 0.1076; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0180; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0170; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1395; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0169; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0158; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0645; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0154; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0148; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0931; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0141; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0138; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0848; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.673841   0.591034   0.728477   0.608738   0.753311   0.615007  
Loss: 0.2401
Fold 1 Epoch 069; Train loss: 0.0135; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0127; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.567881   0.444945   0.850993   0.533306  
Loss: 0.0141
Fold 1 Epoch 041; Train loss: 0.0939; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0125; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0119; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0904; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0116; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0113; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0830; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0106; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0098; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0965; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0092; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0088; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0725; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0082; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0079; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
Fold 1 Epoch 046; Train loss: 0.0515; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.687086   0.489156   0.903974   0.561320  
Loss: 0.0069
Fold 1 Epoch 081; Train loss: 0.0074; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.1214; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0068; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0933; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0055; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0050; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0595; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0045; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0038; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0034; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0600; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.721854   0.642472   0.756623   0.654042   0.783113   0.660834  
Loss: 0.2089
Fold 1 Epoch 089; Train loss: 0.0029; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0025; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.417050   0.927152   0.545137  
Loss: 0.0024
Fold 1 Epoch 051; Train loss: 0.0714; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0020; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0419; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0016; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0013; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0415; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.1018; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0006; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0618; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.1006; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0003; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.413542   0.899007   0.533569  
Loss: 0.0007
[eps candidate 0.0001] Fold 1: HR@10 = [np.float64(0.7350993377483444), np.float64(0.6821192052980133), np.float64(0.7814569536423841), np.float64(0.7168874172185431), np.float64(0.7632450331125827), np.float64(0.7748344370860927), np.float64(0.8509933774834437), np.float64(0.9039735099337748), np.float64(0.9271523178807947), np.float64(0.8990066225165563)]
Tuning eps:  80%|████████  | 4/5 [08:30<02:07, 127.30s/it]
========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 001; Train loss: 0.6562; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0759; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.2528; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.1742; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0926; Time: 00:00:02
Fold 1 Epoch 004; Train loss: 0.1467; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.1329; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0893; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.1174; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.1095; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0402; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.703642   0.629658   0.758278   0.647199   0.779801   0.652697  
Loss: 0.2101
Fold 1 Epoch 008; Train loss: 0.1068; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.1014; Time: 00:00:01
Fold 1 Epoch 061; Train loss: 0.0864; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.0961; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.665563   0.529688   0.791391   0.570250  
Loss: 0.1180
Fold 1 Epoch 011; Train loss: 0.0942; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0688; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.0902; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0898; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.0882; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0909; Time: 00:00:02
Fold 1 Epoch 015; Train loss: 0.0876; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.0810; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0526; Time: 00:00:02
Fold 1 Epoch 017; Train loss: 0.0778; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0760; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0791; Time: 00:00:02
Fold 1 Epoch 019; Train loss: 0.0744; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0732; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
Fold 1 Epoch 066; Train loss: 0.0656; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.605960   0.491240   0.690397   0.517978  
Loss: 0.0855
Fold 1 Epoch 021; Train loss: 0.0690; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0841; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0703; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0681; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0636; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0591; Time: 00:00:02
Fold 1 Epoch 025; Train loss: 0.0614; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0584; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0877; Time: 00:00:02
Fold 1 Epoch 027; Train loss: 0.0579; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0552; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0342; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.740066   0.656686   0.764901   0.664786   0.791391   0.671531  
Loss: 0.1933
Fold 1 Epoch 029; Train loss: 0.0522; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0525; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.582781   0.480633   0.706954   0.520731  
Loss: 0.0600
Fold 1 Epoch 071; Train loss: 0.0908; Time: 00:00:02
Fold 1 Epoch 031; Train loss: 0.0500; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0474; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0899; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0460; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0443; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0769; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0411; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0416; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0540; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0385; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0368; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0430; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0368; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0338; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.622517   0.490677   0.741722   0.529141  
Loss: 0.0386
Fold 1 Epoch 076; Train loss: 0.0885; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0317; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0311; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0464; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0277; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.1100; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0274; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0263; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0651; Time: 00:00:02
Fold 1 Epoch 047; Train loss: 0.0242; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0237; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0584; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.738411   0.653430   0.764901   0.661624   0.781457   0.665824  
Loss: 0.1984
Fold 1 Epoch 049; Train loss: 0.0228; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0221; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
Fold 1 Epoch 081; Train loss: 0.0608; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.682119   0.508623   0.771523   0.537411  
Loss: 0.0223
Fold 1 Epoch 051; Train loss: 0.0211; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0808; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0197; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0185; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0182; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0543; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0174; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0157; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0751; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0155; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0142; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0683; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0136; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0127; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
Fold 1 Epoch 086; Train loss: 0.0745; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.498344   0.399998   0.615894   0.437302  
Loss: 0.0116
Fold 1 Epoch 061; Train loss: 0.0119; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0113; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0483; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0106; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0099; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0455; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0092; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0087; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0294; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0084; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0076; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0826; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.764901   0.698974   0.781457   0.704391   0.811258   0.711866  
Loss: 0.1753
Fold 1 Epoch 069; Train loss: 0.0077; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0069; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.556291   0.399409   0.736755   0.456556  
Loss: 0.0056
Fold 1 Epoch 091; Train loss: 0.0577; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0069; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0062; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0617; Time: 00:00:02
Fold 1 Epoch 073; Train loss: 0.0061; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0061; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0782; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0179; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0051; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0051; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0800; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0046; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.554636   0.327270   0.874172   0.425228  
Loss: 0.0047
Fold 1 Epoch 096; Train loss: 0.0463; Time: 00:00:02
Fold 1 Epoch 081; Train loss: 0.0044; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0043; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.1036; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0038; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0036; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0515; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0034; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0031; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0437; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0027; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0025; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0023; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1142; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.763245   0.681622   0.783113   0.688032   0.799669   0.692203  
Loss: 0.1726
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.754967   0.682708   0.784768   0.692445   0.804636   0.697526  
Loss: 0.1761
Fold 1: Final Test Loss: 0.1761, HR@5: 0.7550
[dropout_rate candidate 0.1] Fold 1: Loss = 0.1761
Tuning dropout_rate based on loss:  25%|██▌       | 1/4 [04:10<12:31, 250.35s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 090; Train loss: 0.0020; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.899007   0.422571  
Loss: 0.0017
Fold 1 Epoch 091; Train loss: 0.0018; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6003; Time: 00:00:03
Fold 1 Epoch 092; Train loss: 0.0016; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5781; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0014; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5474; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0011; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4582; Time: 00:00:02
Fold 1 Epoch 097; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3763; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0005; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.551325   0.316053   0.899007   0.430059  
Loss: 0.0007
[eps candidate 1e-05] Fold 1: HR@10 = [np.float64(0.7913907284768212), np.float64(0.6903973509933775), np.float64(0.706953642384106), np.float64(0.7417218543046358), np.float64(0.7715231788079471), np.float64(0.6158940397350994), np.float64(0.7367549668874173), np.float64(0.8741721854304636), np.float64(0.8990066225165563), np.float64(0.8990066225165563)]
Tuning eps: 100%|██████████| 5/5 [10:38<00:00, 127.41s/it]Tuning eps: 100%|██████████| 5/5 [10:38<00:00, 127.61s/it]

Best eps found: 0.0001
Tuning data for lr saved to ./category/tuning_lr.json
Tuning data for optimizer saved to ./category/tuning_optimizer.json
Tuning data for timesteps saved to ./category/tuning_timesteps.json
Tuning data for dropout_rate saved to ./category/tuning_dropout.json
Tuning data for l2_decay saved to ./category/tuning_l2.json
Tuning data for eps saved to ./category/tuning_eps.json

========== Fold 1 ==========
INFO:root:Using statics: seq_size = 10, genre_vocab_size = 18
Fold 1 Epoch 006; Train loss: 0.3512; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.6045; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.2409; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2776; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.1767; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.1408; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3221; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.1324; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.1128; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2636; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.1053; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1859; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
Fold 1 Epoch 008; Train loss: 0.1032; Time: 00:00:01
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.417219   0.340623   0.511589   0.371165   0.584437   0.389310  
Loss: 0.3710
Fold 1 Epoch 009; Train loss: 0.1013; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.0979; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
Fold 1 Epoch 011; Train loss: 0.2459; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.649007   0.488151   0.740066   0.518202  
Loss: 0.1172
Fold 1 Epoch 011; Train loss: 0.0991; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2220; Time: 00:00:02
Fold 1 Epoch 012; Train loss: 0.0923; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.0901; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2192; Time: 00:00:02
Fold 1 Epoch 014; Train loss: 0.0858; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.0836; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.2199; Time: 00:00:02
Fold 1 Epoch 016; Train loss: 0.0814; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.0805; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2566; Time: 00:00:02
Fold 1 Epoch 018; Train loss: 0.0784; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.0782; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1980; Time: 00:00:02
Fold 1 Epoch 020; Train loss: 0.0745; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.600993   0.453186   0.728477   0.494768  
Loss: 0.0817
Fold 1 Epoch 021; Train loss: 0.0744; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1418; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.0689; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0676; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1425; Time: 00:00:02
Fold 1 Epoch 024; Train loss: 0.0669; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0653; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.2139; Time: 00:00:02
Fold 1 Epoch 026; Train loss: 0.0627; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0598; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2007; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.596026   0.499312   0.662252   0.520784   0.710265   0.532708  
Loss: 0.2829
Fold 1 Epoch 028; Train loss: 0.0565; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0561; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1423; Time: 00:00:02
Fold 1 Epoch 030; Train loss: 0.0560; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.678808   0.522092   0.764901   0.549974  
Loss: 0.0607
Fold 1 Epoch 031; Train loss: 0.0534; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1450; Time: 00:00:02
Fold 1 Epoch 032; Train loss: 0.0512; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1002; Time: 00:00:02
Fold 1 Epoch 033; Train loss: 0.0495; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0476; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1726; Time: 00:00:02
Fold 1 Epoch 035; Train loss: 0.0474; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0463; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1193; Time: 00:00:02
Fold 1 Epoch 037; Train loss: 0.0428; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0413; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1276; Time: 00:00:02
Fold 1 Epoch 039; Train loss: 0.0413; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0400; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.602649   0.450132   0.745033   0.495324  
Loss: 0.0409
Fold 1 Epoch 027; Train loss: 0.1085; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0380; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0360; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1899; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0339; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0331; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1213; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.0315; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0302; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1594; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.644040   0.554458   0.701987   0.573383   0.740066   0.583130  
Loss: 0.2549
Fold 1 Epoch 047; Train loss: 0.0293; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0276; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.1279; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0271; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0248; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.620861   0.465438   0.783113   0.516861  
Loss: 0.0271
Fold 1 Epoch 032; Train loss: 0.1135; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0244; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0227; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0863; Time: 00:00:02
Fold 1 Epoch 053; Train loss: 0.0221; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0208; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0819; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.0200; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0188; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1002; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0174; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0172; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0792; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0165; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0149; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.602649   0.429156   0.807947   0.495913  
Loss: 0.0157
Fold 1 Epoch 037; Train loss: 0.1381; Time: 00:00:02
Fold 1 Epoch 061; Train loss: 0.0139; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0134; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1130; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0124; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0116; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.1195; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0108; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0101; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0707; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.682119   0.600064   0.721854   0.612843   0.753311   0.620687  
Loss: 0.2427
Fold 1 Epoch 067; Train loss: 0.0094; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0089; Time: 00:00:01
Fold 1 Epoch 041; Train loss: 0.1282; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0085; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0078; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
Fold 1 Epoch 042; Train loss: 0.0675; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.589404   0.400015   0.850993   0.483362  
Loss: 0.0080
Fold 1 Epoch 071; Train loss: 0.0071; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.1128; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0067; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0059; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0055; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.1024; Time: 00:00:02
Fold 1 Epoch 075; Train loss: 0.0049; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0046; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.1166; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0044; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0037; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.1106; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0033; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0029; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
Fold 1 Epoch 047; Train loss: 0.0810; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.544702   0.376066   0.892384   0.483019  
Loss: 0.0034
Fold 1 Epoch 081; Train loss: 0.0025; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0577; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0022; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0019; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0758; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0017; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0014; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.1141; Time: 00:00:02
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.710265   0.643363   0.743377   0.654373   0.774834   0.662345  
Loss: 0.2141
Fold 1 Epoch 086; Train loss: 0.0012; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0010; Time: 00:00:01
Fold 1 Epoch 051; Train loss: 0.0679; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0008; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0747; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0006; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.524834   0.348617   0.892384   0.462444  
Loss: 0.0009
Fold 1 Epoch 091; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0675; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0004; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0932; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0662; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0816; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0002; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0675; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0002; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.524834   0.272921   0.892384   0.394448  
Loss: 0.0003
Tuning fold metrics saved to ./category/fold_metrics_tune.txt
Best candidates saved to ./category/best_candidates.json

========== Running Experimental Folds for Genre Model ==========

========== Experiment p1 ==========
Experiment p1 Epoch 001; Train loss: 0.7645; Time: 00:00:00
Experiment p1 Epoch 002; Train loss: 0.3028; Time: 00:00:00
Fold 1 Epoch 058; Train loss: 0.0460; Time: 00:00:02
Experiment p1 Epoch 003; Train loss: 0.1955; Time: 00:00:00
Experiment p1 Epoch 004; Train loss: 0.1671; Time: 00:00:00
Experiment p1 Epoch 005; Train loss: 0.1426; Time: 00:00:00
Fold 1 Epoch 059; Train loss: 0.0934; Time: 00:00:02
Experiment p1 Epoch 006; Train loss: 0.1293; Time: 00:00:00
Experiment p1 Epoch 007; Train loss: 0.1231; Time: 00:00:00
Experiment p1 Epoch 008; Train loss: 0.1268; Time: 00:00:00
Fold 1 Epoch 060; Train loss: 0.0480; Time: 00:00:02
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.733444   0.650809   0.769868   0.662768   0.793046   0.668573  
Loss: 0.1981
Experiment p1 Epoch 009; Train loss: 0.1129; Time: 00:00:00
Experiment p1 Epoch 010; Train loss: 0.1089; Time: 00:00:00
Experiment p1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.530629   0.419954   0.634934   0.453796  
Loss: 0.1343
Experiment p1 Epoch 011; Train loss: 0.1042; Time: 00:00:00
Fold 1 Epoch 061; Train loss: 0.0570; Time: 00:00:02
Experiment p1 Epoch 012; Train loss: 0.1020; Time: 00:00:00
Experiment p1 Epoch 013; Train loss: 0.1016; Time: 00:00:00
Experiment p1 Epoch 014; Train loss: 0.0984; Time: 00:00:00
Fold 1 Epoch 062; Train loss: 0.0487; Time: 00:00:02
Experiment p1 Epoch 015; Train loss: 0.0942; Time: 00:00:00
Experiment p1 Epoch 016; Train loss: 0.0938; Time: 00:00:00
Experiment p1 Epoch 017; Train loss: 0.0910; Time: 00:00:00
Experiment p1 Epoch 018; Train loss: 0.0882; Time: 00:00:00
Fold 1 Epoch 063; Train loss: 0.0296; Time: 00:00:02
Experiment p1 Epoch 019; Train loss: 0.0859; Time: 00:00:00
Experiment p1 Epoch 020; Train loss: 0.0840; Time: 00:00:00
Experiment p1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.599338   0.465550   0.735927   0.509604  
Loss: 0.1006
Fold 1 Epoch 064; Train loss: 0.0527; Time: 00:00:02
Experiment p1 Epoch 021; Train loss: 0.0839; Time: 00:00:00
Experiment p1 Epoch 022; Train loss: 0.0812; Time: 00:00:00
Experiment p1 Epoch 023; Train loss: 0.0785; Time: 00:00:00
Fold 1 Epoch 065; Train loss: 0.0471; Time: 00:00:02
Experiment p1 Epoch 024; Train loss: 0.0758; Time: 00:00:00
Experiment p1 Epoch 025; Train loss: 0.0740; Time: 00:00:00
Experiment p1 Epoch 026; Train loss: 0.0729; Time: 00:00:00
Fold 1 Epoch 066; Train loss: 0.0873; Time: 00:00:02
Experiment p1 Epoch 027; Train loss: 0.0704; Time: 00:00:00
Experiment p1 Epoch 028; Train loss: 0.0703; Time: 00:00:00
Experiment p1 Epoch 029; Train loss: 0.0689; Time: 00:00:00
Experiment p1 Epoch 030; Train loss: 0.0629; Time: 00:00:00
Experiment p1: Evaluation at Epoch 30
Fold 1 Epoch 067; Train loss: 0.0740; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.572020   0.448522   0.684603   0.484735  
Loss: 0.0761
Experiment p1 Epoch 031; Train loss: 0.0621; Time: 00:00:00
Experiment p1 Epoch 032; Train loss: 0.0628; Time: 00:00:00
Fold 1 Epoch 068; Train loss: 0.0759; Time: 00:00:02
Experiment p1 Epoch 033; Train loss: 0.0601; Time: 00:00:00
Experiment p1 Epoch 034; Train loss: 0.0588; Time: 00:00:00
Experiment p1 Epoch 035; Train loss: 0.0574; Time: 00:00:00
Fold 1 Epoch 069; Train loss: 0.0591; Time: 00:00:02
Experiment p1 Epoch 036; Train loss: 0.0554; Time: 00:00:00
Experiment p1 Epoch 037; Train loss: 0.0528; Time: 00:00:00
Experiment p1 Epoch 038; Train loss: 0.0531; Time: 00:00:00
Experiment p1 Epoch 039; Train loss: 0.0514; Time: 00:00:00
Fold 1 Epoch 070; Train loss: 0.0699; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.723510   0.649542   0.766556   0.663928   0.793046   0.670728  
Loss: 0.1998
Experiment p1 Epoch 040; Train loss: 0.0488; Time: 00:00:00
Experiment p1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.561258   0.440060   0.691225   0.481664  
Loss: 0.0568
Experiment p1 Epoch 041; Train loss: 0.0472; Time: 00:00:00
Fold 1 Epoch 071; Train loss: 0.0672; Time: 00:00:02
Experiment p1 Epoch 042; Train loss: 0.0468; Time: 00:00:00
Experiment p1 Epoch 043; Train loss: 0.0434; Time: 00:00:00
Experiment p1 Epoch 044; Train loss: 0.0429; Time: 00:00:00
Fold 1 Epoch 072; Train loss: 0.0292; Time: 00:00:02
Experiment p1 Epoch 045; Train loss: 0.0417; Time: 00:00:00
Experiment p1 Epoch 046; Train loss: 0.0409; Time: 00:00:00
Experiment p1 Epoch 047; Train loss: 0.0392; Time: 00:00:00
Experiment p1 Epoch 048; Train loss: 0.0382; Time: 00:00:00
Fold 1 Epoch 073; Train loss: 0.0687; Time: 00:00:02
Experiment p1 Epoch 049; Train loss: 0.0362; Time: 00:00:00
Experiment p1 Epoch 050; Train loss: 0.0353; Time: 00:00:00
Experiment p1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.529801   0.373230   0.640728   0.409004  
Loss: 0.0389
Fold 1 Epoch 074; Train loss: 0.0634; Time: 00:00:02
Experiment p1 Epoch 051; Train loss: 0.0339; Time: 00:00:00
Experiment p1 Epoch 052; Train loss: 0.0325; Time: 00:00:00
Experiment p1 Epoch 053; Train loss: 0.0317; Time: 00:00:00
Fold 1 Epoch 075; Train loss: 0.0799; Time: 00:00:02
Experiment p1 Epoch 054; Train loss: 0.0310; Time: 00:00:00
Experiment p1 Epoch 055; Train loss: 0.0295; Time: 00:00:00
Experiment p1 Epoch 056; Train loss: 0.0286; Time: 00:00:00
Fold 1 Epoch 076; Train loss: 0.0660; Time: 00:00:02
Experiment p1 Epoch 057; Train loss: 0.0279; Time: 00:00:00
Experiment p1 Epoch 058; Train loss: 0.0274; Time: 00:00:00
Experiment p1 Epoch 059; Train loss: 0.0267; Time: 00:00:00
Fold 1 Epoch 077; Train loss: 0.0628; Time: 00:00:02
Experiment p1 Epoch 060; Train loss: 0.0251; Time: 00:00:00
Experiment p1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.577815   0.429641   0.744205   0.483245  
Loss: 0.0248
Experiment p1 Epoch 061; Train loss: 0.0246; Time: 00:00:00
Experiment p1 Epoch 062; Train loss: 0.0239; Time: 00:00:00
Fold 1 Epoch 078; Train loss: 0.0591; Time: 00:00:02
Experiment p1 Epoch 063; Train loss: 0.0232; Time: 00:00:00
Experiment p1 Epoch 064; Train loss: 0.0223; Time: 00:00:00
Experiment p1 Epoch 065; Train loss: 0.0216; Time: 00:00:00
Fold 1 Epoch 079; Train loss: 0.0493; Time: 00:00:02
Experiment p1 Epoch 066; Train loss: 0.0213; Time: 00:00:00
Experiment p1 Epoch 067; Train loss: 0.0206; Time: 00:00:00
Experiment p1 Epoch 068; Train loss: 0.0197; Time: 00:00:00
Fold 1 Epoch 080; Train loss: 0.0605; Time: 00:00:02
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.741722   0.659747   0.774834   0.670559   0.799669   0.677119  
Loss: 0.1952
Experiment p1 Epoch 069; Train loss: 0.0197; Time: 00:00:00
Experiment p1 Epoch 070; Train loss: 0.0186; Time: 00:00:00
Experiment p1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.613411   0.446974   0.800497   0.507354  
Loss: 0.0166
Fold 1 Epoch 081; Train loss: 0.0964; Time: 00:00:02
Experiment p1 Epoch 071; Train loss: 0.0174; Time: 00:00:00
Experiment p1 Epoch 072; Train loss: 0.0169; Time: 00:00:00
Experiment p1 Epoch 073; Train loss: 0.0159; Time: 00:00:00
Experiment p1 Epoch 074; Train loss: 0.0155; Time: 00:00:00
Fold 1 Epoch 082; Train loss: 0.0483; Time: 00:00:02
Experiment p1 Epoch 075; Train loss: 0.0143; Time: 00:00:00
Experiment p1 Epoch 076; Train loss: 0.0141; Time: 00:00:00
Experiment p1 Epoch 077; Train loss: 0.0127; Time: 00:00:00
Fold 1 Epoch 083; Train loss: 0.0545; Time: 00:00:02
Experiment p1 Epoch 078; Train loss: 0.0120; Time: 00:00:00
Experiment p1 Epoch 079; Train loss: 0.0112; Time: 00:00:00
Experiment p1 Epoch 080; Train loss: 0.0108; Time: 00:00:00
Experiment p1: Evaluation at Epoch 80
Fold 1 Epoch 084; Train loss: 0.0670; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.634106   0.440599   0.879139   0.524210  
Loss: 0.0097
Experiment p1 Epoch 081; Train loss: 0.0100; Time: 00:00:00
Experiment p1 Epoch 082; Train loss: 0.0092; Time: 00:00:00
Experiment p1 Epoch 083; Train loss: 0.0083; Time: 00:00:00
Fold 1 Epoch 085; Train loss: 0.0346; Time: 00:00:02
Experiment p1 Epoch 084; Train loss: 0.0080; Time: 00:00:00
Experiment p1 Epoch 085; Train loss: 0.0074; Time: 00:00:00
Experiment p1 Epoch 086; Train loss: 0.0066; Time: 00:00:00
Fold 1 Epoch 086; Train loss: 0.0616; Time: 00:00:02
Experiment p1 Epoch 087; Train loss: 0.0063; Time: 00:00:00
Experiment p1 Epoch 088; Train loss: 0.0057; Time: 00:00:00
Experiment p1 Epoch 089; Train loss: 0.0053; Time: 00:00:00
Fold 1 Epoch 087; Train loss: 0.0925; Time: 00:00:02
Experiment p1 Epoch 090; Train loss: 0.0047; Time: 00:00:00
Experiment p1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.530629   0.398574   0.931291   0.535394  
Loss: 0.0052
Experiment p1 Epoch 091; Train loss: 0.0045; Time: 00:00:00
Fold 1 Epoch 088; Train loss: 0.0877; Time: 00:00:02
Experiment p1 Epoch 092; Train loss: 0.0043; Time: 00:00:00
Experiment p1 Epoch 093; Train loss: 0.0039; Time: 00:00:00
Experiment p1 Epoch 094; Train loss: 0.0035; Time: 00:00:00
Fold 1 Epoch 089; Train loss: 0.0837; Time: 00:00:02
Experiment p1 Epoch 095; Train loss: 0.0030; Time: 00:00:00
Experiment p1 Epoch 096; Train loss: 0.0028; Time: 00:00:00
Experiment p1 Epoch 097; Train loss: 0.0026; Time: 00:00:00
Experiment p1 Epoch 098; Train loss: 0.0021; Time: 00:00:00
Fold 1 Epoch 090; Train loss: 0.0715; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.745033   0.674086   0.774834   0.683412   0.796358   0.688820  
Loss: 0.1893
Experiment p1 Epoch 099; Train loss: 0.0019; Time: 00:00:00
Experiment p1 Epoch 100; Train loss: 0.0018; Time: 00:00:00
Experiment p1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.530629   0.398574   0.916391   0.531121  
Loss: 0.0016

========== Experiment p2 ==========
Fold 1 Epoch 091; Train loss: 0.1030; Time: 00:00:02
Experiment p2 Epoch 001; Train loss: 0.7315; Time: 00:00:01
Experiment p2 Epoch 002; Train loss: 0.2892; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0743; Time: 00:00:02
Experiment p2 Epoch 003; Train loss: 0.1942; Time: 00:00:01
Experiment p2 Epoch 004; Train loss: 0.1572; Time: 00:00:01
Experiment p2 Epoch 005; Train loss: 0.1455; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0814; Time: 00:00:02
Experiment p2 Epoch 006; Train loss: 0.1329; Time: 00:00:01
Experiment p2 Epoch 007; Train loss: 0.1228; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0219; Time: 00:00:02
Experiment p2 Epoch 008; Train loss: 0.1112; Time: 00:00:01
Experiment p2 Epoch 009; Train loss: 0.1096; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0445; Time: 00:00:02
Experiment p2 Epoch 010; Train loss: 0.1066; Time: 00:00:01
Experiment p2: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.470199   0.334538   0.735927   0.419453  
Loss: 0.1388
Experiment p2 Epoch 011; Train loss: 0.1030; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0464; Time: 00:00:02
Experiment p2 Epoch 012; Train loss: 0.1010; Time: 00:00:01
Experiment p2 Epoch 013; Train loss: 0.0981; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0507; Time: 00:00:02
Experiment p2 Epoch 014; Train loss: 0.0942; Time: 00:00:01
Experiment p2 Epoch 015; Train loss: 0.0912; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0582; Time: 00:00:02
Experiment p2 Epoch 016; Train loss: 0.0905; Time: 00:00:01
Experiment p2 Epoch 017; Train loss: 0.0885; Time: 00:00:01
Experiment p2 Epoch 018; Train loss: 0.0866; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0518; Time: 00:00:02
Experiment p2 Epoch 019; Train loss: 0.0823; Time: 00:00:01
Experiment p2 Epoch 020; Train loss: 0.0823; Time: 00:00:01
Experiment p2: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10   
0.469371   0.350008   0.668046   0.413236  
Loss: 0.1089
Fold 1 Epoch 100; Train loss: 0.0294; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.746689   0.672763   0.786424   0.685529   0.807947   0.690932  
Loss: 0.1869
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.756623   0.690286   0.784768   0.699404   0.804636   0.704477  
Loss: 0.1840
Fold 1: Final Test Loss: 0.1840, HR@5: 0.7566
[dropout_rate candidate 0.01] Fold 1: Loss = 0.1840
Tuning dropout_rate based on loss:  50%|█████     | 2/4 [08:14<08:13, 246.59s/it]
========== Fold 1 ==========
3883
Experiment p2 Epoch 021; Train loss: 0.0807; Time: 00:00:01
Experiment p2 Epoch 022; Train loss: 0.0787; Time: 00:00:01
Fold 1 Epoch 001; Train loss: 0.6194; Time: 00:00:02
Experiment p2 Epoch 023; Train loss: 0.0772; Time: 00:00:01
Experiment p2 Epoch 024; Train loss: 0.0733; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5784; Time: 00:00:02
Experiment p2 Epoch 025; Train loss: 0.0740; Time: 00:00:01
Experiment p2 Epoch 026; Train loss: 0.0700; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4355; Time: 00:00:02
Experiment p2 Epoch 027; Train loss: 0.0692; Time: 00:00:01
Experiment p2 Epoch 028; Train loss: 0.0676; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4676; Time: 00:00:02
Experiment p2 Epoch 029; Train loss: 0.0651; Time: 00:00:01
Experiment p2 Epoch 030; Train loss: 0.0616; Time: 00:00:01
Experiment p2: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.489238   0.383250   0.811258   0.488758  
Loss: 0.0810
Fold 1 Epoch 005; Train loss: 0.3911; Time: 00:00:02
Experiment p2 Epoch 031; Train loss: 0.0606; Time: 00:00:01
Experiment p2 Epoch 032; Train loss: 0.0617; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.2414; Time: 00:00:02
Experiment p2 Epoch 033; Train loss: 0.0563; Time: 00:00:01
Experiment p2 Epoch 034; Train loss: 0.0565; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2851; Time: 00:00:02
Experiment p2 Epoch 035; Train loss: 0.0557; Time: 00:00:01
Experiment p2 Epoch 036; Train loss: 0.0527; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3397; Time: 00:00:02
Experiment p2 Epoch 037; Train loss: 0.0513; Time: 00:00:01
Experiment p2 Epoch 038; Train loss: 0.0487; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2532; Time: 00:00:02
Experiment p2 Epoch 039; Train loss: 0.0484; Time: 00:00:01
Experiment p2 Epoch 040; Train loss: 0.0477; Time: 00:00:01
Experiment p2: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.475166   0.385247   0.821192   0.497960  
Loss: 0.0553
Fold 1 Epoch 010; Train loss: 0.2157; Time: 00:00:02
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.461921   0.377105   0.524834   0.397573   0.579470   0.411094  
Loss: 0.3520
Experiment p2 Epoch 041; Train loss: 0.0459; Time: 00:00:01
Experiment p2 Epoch 042; Train loss: 0.0434; Time: 00:00:01
Fold 1 Epoch 011; Train loss: 0.2233; Time: 00:00:02
Experiment p2 Epoch 043; Train loss: 0.0428; Time: 00:00:01
Experiment p2 Epoch 044; Train loss: 0.0414; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1902; Time: 00:00:02
Experiment p2 Epoch 045; Train loss: 0.0402; Time: 00:00:01
Experiment p2 Epoch 046; Train loss: 0.0403; Time: 00:00:01
Experiment p2 Epoch 047; Train loss: 0.0364; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1711; Time: 00:00:02
Experiment p2 Epoch 048; Train loss: 0.0363; Time: 00:00:01
Experiment p2 Epoch 049; Train loss: 0.0351; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1700; Time: 00:00:02
Experiment p2 Epoch 050; Train loss: 0.0344; Time: 00:00:01
Experiment p2: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.388245   0.264941   0.750000   0.377523  
Loss: 0.0389
Fold 1 Epoch 015; Train loss: 0.1492; Time: 00:00:02
Experiment p2 Epoch 051; Train loss: 0.0329; Time: 00:00:01
Experiment p2 Epoch 052; Train loss: 0.0312; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1865; Time: 00:00:02
Experiment p2 Epoch 053; Train loss: 0.0303; Time: 00:00:01
Experiment p2 Epoch 054; Train loss: 0.0296; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1361; Time: 00:00:02
Experiment p2 Epoch 055; Train loss: 0.0286; Time: 00:00:01
Experiment p2 Epoch 056; Train loss: 0.0269; Time: 00:00:01
Experiment p2 Epoch 057; Train loss: 0.0266; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1552; Time: 00:00:02
Experiment p2 Epoch 058; Train loss: 0.0255; Time: 00:00:01
Experiment p2 Epoch 059; Train loss: 0.0247; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1298; Time: 00:00:02
Experiment p2 Epoch 060; Train loss: 0.0244; Time: 00:00:01
Experiment p2: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.401490   0.267999   0.800497   0.398371  
Loss: 0.0256
Experiment p2 Epoch 061; Train loss: 0.0228; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1343; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.615894   0.532495   0.660596   0.546861   0.721854   0.562507  
Loss: 0.2652
Experiment p2 Epoch 062; Train loss: 0.0221; Time: 00:00:01
Experiment p2 Epoch 063; Train loss: 0.0212; Time: 00:00:01
Fold 1 Epoch 021; Train loss: 0.1355; Time: 00:00:02
Experiment p2 Epoch 064; Train loss: 0.0201; Time: 00:00:01
Experiment p2 Epoch 065; Train loss: 0.0193; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1321; Time: 00:00:02
Experiment p2 Epoch 066; Train loss: 0.0183; Time: 00:00:01
Experiment p2 Epoch 067; Train loss: 0.0179; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1456; Time: 00:00:02
Experiment p2 Epoch 068; Train loss: 0.0162; Time: 00:00:01
Experiment p2 Epoch 069; Train loss: 0.0160; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1020; Time: 00:00:02
Experiment p2 Epoch 070; Train loss: 0.0147; Time: 00:00:01
Experiment p2: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.433775   0.253214   0.849338   0.385456  
Loss: 0.0131
Experiment p2 Epoch 071; Train loss: 0.0140; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1176; Time: 00:00:02
Experiment p2 Epoch 072; Train loss: 0.0132; Time: 00:00:01
Experiment p2 Epoch 073; Train loss: 0.0118; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1346; Time: 00:00:02
Experiment p2 Epoch 074; Train loss: 0.0106; Time: 00:00:01
Experiment p2 Epoch 075; Train loss: 0.0099; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1313; Time: 00:00:02
Experiment p2 Epoch 076; Train loss: 0.0096; Time: 00:00:01
Experiment p2 Epoch 077; Train loss: 0.0087; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1441; Time: 00:00:02
Experiment p2 Epoch 078; Train loss: 0.0083; Time: 00:00:01
Experiment p2 Epoch 079; Train loss: 0.0075; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0863; Time: 00:00:02
Experiment p2 Epoch 080; Train loss: 0.0070; Time: 00:00:01
Experiment p2: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.461093   0.252685   0.889901   0.392701  
Loss: 0.0056
Experiment p2 Epoch 081; Train loss: 0.0067; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1152; Time: 00:00:02
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.640728   0.556065   0.705298   0.576837   0.738411   0.585288  
Loss: 0.2488
Experiment p2 Epoch 082; Train loss: 0.0063; Time: 00:00:01
Experiment p2 Epoch 083; Train loss: 0.0059; Time: 00:00:01
Experiment p2 Epoch 084; Train loss: 0.0056; Time: 00:00:01
Fold 1 Epoch 031; Train loss: 0.1181; Time: 00:00:02
Experiment p2 Epoch 085; Train loss: 0.0053; Time: 00:00:01
Experiment p2 Epoch 086; Train loss: 0.0048; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0975; Time: 00:00:02
Experiment p2 Epoch 087; Train loss: 0.0043; Time: 00:00:01
Experiment p2 Epoch 088; Train loss: 0.0039; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1098; Time: 00:00:02
Experiment p2 Epoch 089; Train loss: 0.0034; Time: 00:00:01
Experiment p2 Epoch 090; Train loss: 0.0030; Time: 00:00:01
Experiment p2: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10   
0.529801   0.284867   0.873344   0.391400  
Loss: 0.0018
Fold 1 Epoch 034; Train loss: 0.1025; Time: 00:00:02
Experiment p2 Epoch 091; Train loss: 0.0024; Time: 00:00:01
Experiment p2 Epoch 092; Train loss: 0.0020; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0824; Time: 00:00:02
Experiment p2 Epoch 093; Train loss: 0.0016; Time: 00:00:01
Experiment p2 Epoch 094; Train loss: 0.0012; Time: 00:00:01
Experiment p2 Epoch 095; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0863; Time: 00:00:02
Experiment p2 Epoch 096; Train loss: 0.0007; Time: 00:00:01
Experiment p2 Epoch 097; Train loss: 0.0005; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0808; Time: 00:00:02
Experiment p2 Epoch 098; Train loss: 0.0004; Time: 00:00:01
Experiment p2 Epoch 099; Train loss: 0.0003; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1541; Time: 00:00:02
Experiment p2 Epoch 100; Train loss: 0.0003; Time: 00:00:01
Experiment p2: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.529801   0.246292   0.893212   0.358842  
Loss: 0.0004
Experimental fold metrics saved to category/genre_exp_p1_metrics.txt and category/genre_exp_p2_metrics.txt

========== Running Experimental Fold p3 for Genre Model ==========

========== Experiment p3 ==========
Fold 1 Epoch 039; Train loss: 0.1199; Time: 00:00:02
Experiment p3 Epoch 001; Train loss: 0.7034; Time: 00:00:02
Experiment p3 Epoch 002; Train loss: 0.2754; Time: 00:00:02
Fold 1 Epoch 040; Train loss: 0.1178; Time: 00:00:02
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.682119   0.592596   0.725166   0.606779   0.754967   0.614187  
Loss: 0.2361
Experiment p3 Epoch 003; Train loss: 0.1905; Time: 00:00:02
Fold 1 Epoch 041; Train loss: 0.0587; Time: 00:00:02
Experiment p3 Epoch 004; Train loss: 0.1576; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0897; Time: 00:00:02
Experiment p3 Epoch 005; Train loss: 0.1345; Time: 00:00:02
Experiment p3 Epoch 006; Train loss: 0.1283; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.1459; Time: 00:00:03
Experiment p3 Epoch 007; Train loss: 0.1140; Time: 00:00:02
Fold 1 Epoch 044; Train loss: 0.0792; Time: 00:00:02
Experiment p3 Epoch 008; Train loss: 0.1079; Time: 00:00:02
Experiment p3 Epoch 009; Train loss: 0.1037; Time: 00:00:02
Fold 1 Epoch 045; Train loss: 0.1244; Time: 00:00:02
Experiment p3 Epoch 010; Train loss: 0.1033; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10   
0.471854   0.368422   0.653974   0.426845  
Loss: 0.1328
Fold 1 Epoch 046; Train loss: 0.0779; Time: 00:00:02
Experiment p3 Epoch 011; Train loss: 0.0981; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0763; Time: 00:00:03
Experiment p3 Epoch 012; Train loss: 0.0953; Time: 00:00:02
Experiment p3 Epoch 013; Train loss: 0.0937; Time: 00:00:02
Fold 1 Epoch 048; Train loss: 0.0679; Time: 00:00:02
Experiment p3 Epoch 014; Train loss: 0.0917; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.1112; Time: 00:00:02
Experiment p3 Epoch 015; Train loss: 0.0906; Time: 00:00:02
Fold 1 Epoch 050; Train loss: 0.0814; Time: 00:00:03
Fold 1: Evaluation at Epoch 50
Experiment p3 Epoch 016; Train loss: 0.0862; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.698675   0.615407   0.746689   0.631166   0.776490   0.638898  
Loss: 0.2100
Experiment p3 Epoch 017; Train loss: 0.0833; Time: 00:00:02
Fold 1 Epoch 051; Train loss: 0.0908; Time: 00:00:03
Experiment p3 Epoch 018; Train loss: 0.0840; Time: 00:00:02
Fold 1 Epoch 052; Train loss: 0.0842; Time: 00:00:02
Experiment p3 Epoch 019; Train loss: 0.0827; Time: 00:00:02
Experiment p3 Epoch 020; Train loss: 0.0766; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 20
Fold 1 Epoch 053; Train loss: 0.0971; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.543046   0.403162   0.685430   0.448620  
Loss: 0.1028
Experiment p3 Epoch 021; Train loss: 0.0762; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.0769; Time: 00:00:02
Experiment p3 Epoch 022; Train loss: 0.0755; Time: 00:00:02
Fold 1 Epoch 055; Train loss: 0.1058; Time: 00:00:03
Experiment p3 Epoch 023; Train loss: 0.0730; Time: 00:00:02
Fold 1 Epoch 056; Train loss: 0.0667; Time: 00:00:02
Experiment p3 Epoch 024; Train loss: 0.0727; Time: 00:00:02
Experiment p3 Epoch 025; Train loss: 0.0703; Time: 00:00:02
Fold 1 Epoch 057; Train loss: 0.0734; Time: 00:00:02
Experiment p3 Epoch 026; Train loss: 0.0685; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0881; Time: 00:00:02
Experiment p3 Epoch 027; Train loss: 0.0661; Time: 00:00:01
Experiment p3 Epoch 028; Train loss: 0.0626; Time: 00:00:02
Fold 1 Epoch 059; Train loss: 0.0881; Time: 00:00:03
Experiment p3 Epoch 029; Train loss: 0.0626; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.1295; Time: 00:00:03
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.701987   0.620919   0.735099   0.631639   0.778146   0.642420  
Loss: 0.2166
Experiment p3 Epoch 030; Train loss: 0.0605; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10   
0.556291   0.401099   0.738411   0.459445  
Loss: 0.0826
Fold 1 Epoch 061; Train loss: 0.1544; Time: 00:00:02
Experiment p3 Epoch 031; Train loss: 0.0568; Time: 00:00:02
Experiment p3 Epoch 032; Train loss: 0.0587; Time: 00:00:02
Fold 1 Epoch 062; Train loss: 0.0533; Time: 00:00:02
Experiment p3 Epoch 033; Train loss: 0.0555; Time: 00:00:02
Fold 1 Epoch 063; Train loss: 0.0802; Time: 00:00:03
Experiment p3 Epoch 034; Train loss: 0.0533; Time: 00:00:01
Experiment p3 Epoch 035; Train loss: 0.0534; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0538; Time: 00:00:02
Experiment p3 Epoch 036; Train loss: 0.0513; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0681; Time: 00:00:02
Experiment p3 Epoch 037; Train loss: 0.0489; Time: 00:00:01
Experiment p3 Epoch 038; Train loss: 0.0476; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0552; Time: 00:00:02
Experiment p3 Epoch 039; Train loss: 0.0455; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.1107; Time: 00:00:03
Experiment p3 Epoch 040; Train loss: 0.0449; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10   
0.513245   0.372534   0.784768   0.459259  
Loss: 0.0533
Fold 1 Epoch 068; Train loss: 0.1111; Time: 00:00:02
Experiment p3 Epoch 041; Train loss: 0.0443; Time: 00:00:01
Experiment p3 Epoch 042; Train loss: 0.0427; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0579; Time: 00:00:02
Experiment p3 Epoch 043; Train loss: 0.0414; Time: 00:00:02
Fold 1 Epoch 070; Train loss: 0.0604; Time: 00:00:02
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.705298   0.633239   0.759934   0.651078   0.799669   0.661062  
Loss: 0.1959
Experiment p3 Epoch 044; Train loss: 0.0396; Time: 00:00:02
Experiment p3 Epoch 045; Train loss: 0.0379; Time: 00:00:02
Fold 1 Epoch 071; Train loss: 0.0658; Time: 00:00:02
Experiment p3 Epoch 046; Train loss: 0.0362; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0876; Time: 00:00:02
Experiment p3 Epoch 047; Train loss: 0.0356; Time: 00:00:02
Experiment p3 Epoch 048; Train loss: 0.0339; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0573; Time: 00:00:03
Experiment p3 Epoch 049; Train loss: 0.0329; Time: 00:00:02
Fold 1 Epoch 074; Train loss: 0.0840; Time: 00:00:02
Experiment p3 Epoch 050; Train loss: 0.0313; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10   
0.506623   0.364543   0.802980   0.459511  
Loss: 0.0355
Fold 1 Epoch 075; Train loss: 0.0747; Time: 00:00:02
Experiment p3 Epoch 051; Train loss: 0.0293; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.1077; Time: 00:00:02
Experiment p3 Epoch 052; Train loss: 0.0282; Time: 00:00:02
Experiment p3 Epoch 053; Train loss: 0.0268; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0990; Time: 00:00:02
Experiment p3 Epoch 054; Train loss: 0.0254; Time: 00:00:02
Fold 1 Epoch 078; Train loss: 0.0656; Time: 00:00:02
Experiment p3 Epoch 055; Train loss: 0.0243; Time: 00:00:01
Experiment p3 Epoch 056; Train loss: 0.0231; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0400; Time: 00:00:02
Experiment p3 Epoch 057; Train loss: 0.0226; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0463; Time: 00:00:03
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.740066   0.663703   0.774834   0.675027   0.794702   0.680105  
Loss: 0.1858
Experiment p3 Epoch 058; Train loss: 0.0209; Time: 00:00:01
Fold 1 Epoch 081; Train loss: 0.0791; Time: 00:00:02
Experiment p3 Epoch 059; Train loss: 0.0193; Time: 00:00:01
Experiment p3 Epoch 060; Train loss: 0.0192; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10   
0.412252   0.319980   0.793046   0.443823  
Loss: 0.0192
Fold 1 Epoch 082; Train loss: 0.0799; Time: 00:00:02
Experiment p3 Epoch 061; Train loss: 0.0180; Time: 00:00:02
Fold 1 Epoch 083; Train loss: 0.0744; Time: 00:00:02
Experiment p3 Epoch 062; Train loss: 0.0175; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0442; Time: 00:00:03
Experiment p3 Epoch 063; Train loss: 0.0165; Time: 00:00:02
Experiment p3 Epoch 064; Train loss: 0.0168; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0465; Time: 00:00:03
Experiment p3 Epoch 065; Train loss: 0.0152; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0517; Time: 00:00:02
Experiment p3 Epoch 066; Train loss: 0.0147; Time: 00:00:02
Experiment p3 Epoch 067; Train loss: 0.0135; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0585; Time: 00:00:02
Experiment p3 Epoch 068; Train loss: 0.0138; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0283; Time: 00:00:02
Experiment p3 Epoch 069; Train loss: 0.0133; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0449; Time: 00:00:02
Experiment p3 Epoch 070; Train loss: 0.0122; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10   
0.437086   0.311544   0.839404   0.444906  
Loss: 0.0123
Fold 1 Epoch 090; Train loss: 0.0930; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.746689   0.668467   0.774834   0.677817   0.801325   0.684558  
Loss: 0.1827
Experiment p3 Epoch 071; Train loss: 0.0117; Time: 00:00:02
Experiment p3 Epoch 072; Train loss: 0.0113; Time: 00:00:02
Fold 1 Epoch 091; Train loss: 0.0420; Time: 00:00:02
Experiment p3 Epoch 073; Train loss: 0.0109; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0685; Time: 00:00:02
Experiment p3 Epoch 074; Train loss: 0.0098; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0508; Time: 00:00:03
Experiment p3 Epoch 075; Train loss: 0.0100; Time: 00:00:01
Experiment p3 Epoch 076; Train loss: 0.0091; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0538; Time: 00:00:02
Experiment p3 Epoch 077; Train loss: 0.0083; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0648; Time: 00:00:02
Experiment p3 Epoch 078; Train loss: 0.0078; Time: 00:00:02
Experiment p3 Epoch 079; Train loss: 0.0073; Time: 00:00:02
Fold 1 Epoch 096; Train loss: 0.0605; Time: 00:00:02
Experiment p3 Epoch 080; Train loss: 0.0065; Time: 00:00:01
Experiment p3: Validation Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10   
0.377483   0.304600   0.887417   0.469546  
Loss: 0.0066
Fold 1 Epoch 097; Train loss: 0.0710; Time: 00:00:02
Experiment p3 Epoch 081; Train loss: 0.0065; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0816; Time: 00:00:02
Experiment p3 Epoch 082; Train loss: 0.0060; Time: 00:00:02
Experiment p3 Epoch 083; Train loss: 0.0054; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0325; Time: 00:00:03
Experiment p3 Epoch 084; Train loss: 0.0050; Time: 00:00:02
Fold 1 Epoch 100; Train loss: 0.0528; Time: 00:00:03
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.725166   0.645152   0.758278   0.655853   0.784768   0.662514  
Loss: 0.1969
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.731788   0.658438   0.779801   0.673662   0.802980   0.679745  
Loss: 0.1842
Fold 1: Final Test Loss: 0.1842, HR@5: 0.7318
[dropout_rate candidate 0.0001] Fold 1: Loss = 0.1842
Tuning dropout_rate based on loss:  75%|███████▌  | 3/4 [12:50<04:20, 260.10s/it]
========== Fold 1 ==========
3883
Experiment p3 Epoch 085; Train loss: 0.0045; Time: 00:00:02
Experiment p3 Epoch 086; Train loss: 0.0041; Time: 00:00:02
Fold 1 Epoch 001; Train loss: 0.5808; Time: 00:00:02
Experiment p3 Epoch 087; Train loss: 0.0036; Time: 00:00:02
Fold 1 Epoch 002; Train loss: 0.5296; Time: 00:00:02
Experiment p3 Epoch 088; Train loss: 0.0031; Time: 00:00:02
Fold 1 Epoch 003; Train loss: 0.5138; Time: 00:00:02
Experiment p3 Epoch 089; Train loss: 0.0027; Time: 00:00:02
Experiment p3 Epoch 090; Train loss: 0.0023; Time: 00:00:02
Experiment p3: Validation Evaluation at Epoch 90
Fold 1 Epoch 004; Train loss: 0.4133; Time: 00:00:02
HR@5       NDCG@5     HR@10      NDCG@10   
0.395695   0.334104   0.895695   0.495971  
Loss: 0.0028
Experiment p3 Epoch 091; Train loss: 0.0020; Time: 00:00:02
Fold 1 Epoch 005; Train loss: 0.3338; Time: 00:00:02
Experiment p3 Epoch 092; Train loss: 0.0016; Time: 00:00:02
Fold 1 Epoch 006; Train loss: 0.3607; Time: 00:00:02
Experiment p3 Epoch 093; Train loss: 0.0014; Time: 00:00:01
Experiment p3 Epoch 094; Train loss: 0.0011; Time: 00:00:02
Fold 1 Epoch 007; Train loss: 0.2864; Time: 00:00:02
Experiment p3 Epoch 095; Train loss: 0.0009; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2454; Time: 00:00:02
Experiment p3 Epoch 096; Train loss: 0.0007; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2535; Time: 00:00:02
Experiment p3 Epoch 097; Train loss: 0.0006; Time: 00:00:02
Experiment p3 Epoch 098; Train loss: 0.0005; Time: 00:00:02
Fold 1 Epoch 010; Train loss: 0.2417; Time: 00:00:03
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.432119   0.342603   0.506623   0.366617   0.561258   0.380453  
Loss: 0.3769
Experiment p3 Epoch 099; Train loss: 0.0004; Time: 00:00:02
Fold 1 Epoch 011; Train loss: 0.2495; Time: 00:00:02
Experiment p3 Epoch 100; Train loss: 0.0004; Time: 00:00:01
Experiment p3: Validation Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10   
0.394040   0.337646   0.890728   0.498667  
Loss: 0.0005
Final Evaluation on p3 test set:
HR@5       NDCG@5     HR@10      NDCG@10   
0.336093   0.185579   0.870861   0.353901  
Loss: 0.0007
Experimental fold metrics saved to category/genre_exp_p3_metrics.txt
Fold 1 Epoch 012; Train loss: 0.2307; Time: 00:00:02
Fold 1 Epoch 013; Train loss: 0.2057; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1657; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1729; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2072; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1749; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.0931; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1242; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1122; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.600993   0.508559   0.663907   0.528961   0.713576   0.541589  
Loss: 0.2823
Fold 1 Epoch 021; Train loss: 0.1354; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1040; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.0832; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1734; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1215; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0932; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1714; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1132; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0954; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1318; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.652318   0.568761   0.713576   0.588829   0.746689   0.597254  
Loss: 0.2546
Fold 1 Epoch 031; Train loss: 0.1356; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1254; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.1204; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1112; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0783; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1061; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0903; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1053; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0903; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.1014; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.698675   0.609044   0.735099   0.620870   0.756623   0.626311  
Loss: 0.2320
Fold 1 Epoch 041; Train loss: 0.1208; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0878; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0889; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0972; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0599; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.1091; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0895; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0896; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0458; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0857; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.706954   0.628272   0.761589   0.646322   0.781457   0.651477  
Loss: 0.2075
Fold 1 Epoch 051; Train loss: 0.0749; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0764; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0636; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0702; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0751; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0803; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.1104; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0508; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.1075; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0724; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.695364   0.621491   0.741722   0.636671   0.781457   0.646793  
Loss: 0.2120
Fold 1 Epoch 061; Train loss: 0.0694; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0733; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0937; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0938; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0576; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0617; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0437; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0664; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0768; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0746; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.713576   0.636521   0.750000   0.648353   0.781457   0.656182  
Loss: 0.2013
Fold 1 Epoch 071; Train loss: 0.1013; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0843; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0578; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0532; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.1071; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0595; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0698; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0454; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0395; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0561; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.718543   0.648224   0.754967   0.659794   0.789735   0.668650  
Loss: 0.1996
Fold 1 Epoch 081; Train loss: 0.0518; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0667; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0562; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0387; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0559; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0834; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0327; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0530; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0417; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0496; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.751656   0.684046   0.773179   0.691031   0.798013   0.697361  
Loss: 0.1817
Fold 1 Epoch 091; Train loss: 0.0843; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0962; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0551; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0547; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0513; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0249; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0583; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0724; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0410; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0918; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.741722   0.665977   0.778146   0.678099   0.801325   0.683980  
Loss: 0.1820
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.745033   0.671246   0.783113   0.683793   0.801325   0.688419  
Loss: 0.1786
Fold 1: Final Test Loss: 0.1786, HR@5: 0.7450
[dropout_rate candidate 1e-08] Fold 1: Loss = 0.1786
Tuning dropout_rate based on loss: 100%|██████████| 4/4 [16:06<00:00, 234.67s/it]Tuning dropout_rate based on loss: 100%|██████████| 4/4 [16:06<00:00, 241.54s/it]

Best dropout_rate based on loss: 0.1
Tuning data for dropout_rate (loss) saved to ./item/tuning_dropout.json
Tuning l2_decay based on loss:   0%|          | 0/4 [00:00<?, ?it/s]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.6003; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5672; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5570; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4862; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3958; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.4728; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.3943; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3781; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.3217; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2824; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.317881   0.240903   0.403974   0.269388   0.488411   0.290719  
Loss: 0.4029
Fold 1 Epoch 011; Train loss: 0.2917; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2980; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2523; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.2498; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2799; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2540; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.3057; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.2972; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.2029; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.2477; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.440397   0.364232   0.500000   0.383194   0.562914   0.399057  
Loss: 0.3435
Fold 1 Epoch 021; Train loss: 0.2216; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.2737; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.2375; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.3095; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.2346; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.2340; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.2474; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.2150; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.2857; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.2120; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.422185   0.331482   0.485099   0.351846   0.556291   0.369899  
Loss: 0.3420
Fold 1 Epoch 031; Train loss: 0.2366; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.2024; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.2153; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.2396; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.2305; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.2310; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1893; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.2052; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.2067; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.2533; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.442053   0.368851   0.504967   0.389368   0.561258   0.403612  
Loss: 0.3377
Fold 1 Epoch 041; Train loss: 0.2385; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.2402; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.2345; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.2340; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.1465; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.2329; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.2554; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.2115; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.2034; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.2139; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.428808   0.363986   0.486755   0.382680   0.548013   0.397970  
Loss: 0.3431
Fold 1 Epoch 051; Train loss: 0.2166; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.2282; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.2780; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.2564; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.1778; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.2107; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.1685; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.1970; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.2203; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.2290; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.438742   0.363534   0.498344   0.382817   0.556291   0.397389  
Loss: 0.3457
Fold 1 Epoch 061; Train loss: 0.1735; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.2228; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.2303; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.2208; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.1975; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.2129; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.1867; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.1643; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.1757; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.2101; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.470199   0.384286   0.529801   0.403422   0.599338   0.421157  
Loss: 0.3216
Fold 1 Epoch 071; Train loss: 0.2282; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.2131; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.2198; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.1955; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.2397; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.2480; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.2633; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.2091; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.2866; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.2189; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.448675   0.362651   0.506623   0.381310   0.569536   0.397201  
Loss: 0.3399
Fold 1 Epoch 081; Train loss: 0.1900; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1863; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.2174; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.2088; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.2152; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.1714; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.1917; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.2982; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.1864; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.1686; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.433775   0.350873   0.486755   0.368226   0.538079   0.381382  
Loss: 0.3543
Fold 1 Epoch 091; Train loss: 0.2219; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.1327; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.1967; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.2385; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1675; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.2104; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.2535; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.2290; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.1239; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.2342; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.423841   0.345275   0.488411   0.366579   0.539735   0.379605  
Loss: 0.3534
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.475166   0.383153   0.528146   0.400602   0.571192   0.411645  
Loss: 0.3420
Fold 1: Final Test Loss: 0.3420, HR@5: 0.4752
[l2_decay candidate 0.1] Fold 1: Loss = 0.3420
Tuning l2_decay based on loss:  25%|██▌       | 1/4 [02:54<08:43, 174.64s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.6015; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5834; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.5521; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.5069; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3858; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3251; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.3225; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2236; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.3219; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2216; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.408940   0.331843   0.498344   0.361099   0.551325   0.374707  
Loss: 0.3818
Fold 1 Epoch 011; Train loss: 0.1720; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1820; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1914; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.2260; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.2096; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1705; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.2010; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1394; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1754; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1612; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.571192   0.480382   0.639073   0.502383   0.685430   0.514157  
Loss: 0.2943
Fold 1 Epoch 021; Train loss: 0.1909; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1253; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1389; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0986; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1016; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1264; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1295; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1288; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1434; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1007; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.663907   0.554648   0.715232   0.571366   0.754967   0.581480  
Loss: 0.2622
Fold 1 Epoch 031; Train loss: 0.1090; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0694; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0698; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1230; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0950; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0728; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.1210; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0725; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.1002; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0761; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.698675   0.620991   0.736755   0.633500   0.773179   0.642521  
Loss: 0.2296
Fold 1 Epoch 041; Train loss: 0.1239; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0900; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.1051; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0874; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0796; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0790; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0641; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0561; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0908; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0423; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.693709   0.614717   0.745033   0.631425   0.778146   0.639879  
Loss: 0.2248
Fold 1 Epoch 051; Train loss: 0.0607; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.1017; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0502; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0671; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0736; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0984; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0520; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0466; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0574; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0475; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.723510   0.655579   0.763245   0.668435   0.796358   0.676765  
Loss: 0.2056
Fold 1 Epoch 061; Train loss: 0.0591; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0663; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0769; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0905; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0500; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0874; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0646; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0574; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0369; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0773; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.728477   0.641368   0.764901   0.653363   0.791391   0.660138  
Loss: 0.2111
Fold 1 Epoch 071; Train loss: 0.0550; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0481; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0778; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0495; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0478; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0523; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.1164; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0475; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0527; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0630; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.736755   0.674280   0.771523   0.685608   0.794702   0.691368  
Loss: 0.1926
Fold 1 Epoch 081; Train loss: 0.0527; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0870; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0862; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0423; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0771; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0788; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0675; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0458; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0635; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0843; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.745033   0.680315   0.769868   0.688349   0.801325   0.696439  
Loss: 0.1846
Fold 1 Epoch 091; Train loss: 0.0470; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0442; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0646; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0804; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0679; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0383; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0275; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0682; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0514; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0225; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.748344   0.675913   0.778146   0.685730   0.802980   0.692041  
Loss: 0.1857
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.758278   0.670947   0.784768   0.679609   0.804636   0.684721  
Loss: 0.1895
Fold 1: Final Test Loss: 0.1895, HR@5: 0.7583
[l2_decay candidate 0.01] Fold 1: Loss = 0.1895
Tuning l2_decay based on loss:  50%|█████     | 2/4 [05:53<05:53, 176.93s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.5914; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5592; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4758; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4427; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4157; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.2480; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.3160; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2778; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2568; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2314; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.458609   0.379412   0.534768   0.404030   0.597682   0.419837  
Loss: 0.3517
Fold 1 Epoch 011; Train loss: 0.2434; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2200; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1636; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1816; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1877; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1438; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1788; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1509; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1398; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1605; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.622517   0.535731   0.678808   0.554014   0.720199   0.564554  
Loss: 0.2719
Fold 1 Epoch 021; Train loss: 0.1147; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.0820; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1426; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.0921; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1110; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1189; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1360; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0989; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0691; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.1672; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.663907   0.591875   0.723510   0.611377   0.764901   0.622123  
Loss: 0.2424
Fold 1 Epoch 031; Train loss: 0.0660; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0762; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0679; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.1007; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1003; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0865; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0888; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.1211; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0924; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0754; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.697020   0.616841   0.741722   0.631413   0.788079   0.643269  
Loss: 0.2183
Fold 1 Epoch 041; Train loss: 0.0661; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.1380; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0749; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0940; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0535; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0943; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0708; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0704; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0492; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0560; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.706954   0.637176   0.756623   0.652992   0.786424   0.660656  
Loss: 0.2195
Fold 1 Epoch 051; Train loss: 0.0823; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0676; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0856; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0846; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0642; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0427; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0753; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0941; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0859; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0831; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.753311   0.678475   0.784768   0.688813   0.801325   0.693068  
Loss: 0.1969
Fold 1 Epoch 061; Train loss: 0.0838; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.1057; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0485; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0452; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0555; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0702; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0228; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0865; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0746; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0432; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.776490   0.705665   0.796358   0.712087   0.809603   0.715368  
Loss: 0.1910
Fold 1 Epoch 071; Train loss: 0.0290; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0299; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0365; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0780; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0588; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0919; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0491; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0416; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0463; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0435; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.759934   0.695797   0.786424   0.704580   0.804636   0.709364  
Loss: 0.1850
Fold 1 Epoch 081; Train loss: 0.0609; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0312; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0501; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0476; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0409; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0191; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0236; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0378; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0573; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0385; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.759934   0.681600   0.789735   0.691254   0.809603   0.696534  
Loss: 0.1903
Fold 1 Epoch 091; Train loss: 0.0525; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0734; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0395; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0767; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0520; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0296; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0514; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0318; Time: 00:00:02
Fold 1 Epoch 099; Train loss: 0.0312; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0395; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.776490   0.719882   0.806291   0.729665   0.817881   0.732586  
Loss: 0.1793
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.789735   0.715858   0.806291   0.720979   0.824503   0.725776  
Loss: 0.1805
Fold 1: Final Test Loss: 0.1805, HR@5: 0.7897
[l2_decay candidate 0.0001] Fold 1: Loss = 0.1805
Tuning l2_decay based on loss:  75%|███████▌  | 3/4 [08:57<03:00, 180.13s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.6230; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5692; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4930; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4748; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.4130; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.3115; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2951; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.3294; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2283; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2887; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.476821   0.382771   0.559603   0.409320   0.610927   0.422031  
Loss: 0.3461
Fold 1 Epoch 011; Train loss: 0.2369; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1901; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.1682; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1720; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1272; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1548; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1920; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1486; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1488; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1411; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.607616   0.523977   0.663907   0.541999   0.708609   0.553492  
Loss: 0.2788
Fold 1 Epoch 021; Train loss: 0.0864; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1426; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1094; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1341; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1341; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1319; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0726; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1120; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1467; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0518; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.688742   0.601717   0.731788   0.615854   0.768212   0.625185  
Loss: 0.2466
Fold 1 Epoch 031; Train loss: 0.0838; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.1117; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0734; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0764; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0645; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.0802; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0851; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0983; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0883; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0704; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.718543   0.641056   0.756623   0.653343   0.783113   0.660081  
Loss: 0.2184
Fold 1 Epoch 041; Train loss: 0.0423; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0389; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0855; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0885; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0845; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0432; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0559; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0658; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0440; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0592; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.738411   0.672667   0.763245   0.680803   0.794702   0.688902  
Loss: 0.2089
Fold 1 Epoch 051; Train loss: 0.0753; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0603; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0707; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0608; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0819; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0542; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0824; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0597; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0552; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0382; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.766556   0.691954   0.789735   0.699644   0.807947   0.704252  
Loss: 0.1939
Fold 1 Epoch 061; Train loss: 0.0758; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0564; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0643; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0901; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0428; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0609; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0525; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0563; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0486; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0350; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.773179   0.704659   0.801325   0.713858   0.817881   0.718001  
Loss: 0.1887
Fold 1 Epoch 071; Train loss: 0.0282; Time: 00:00:02
Fold 1 Epoch 072; Train loss: 0.0661; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0441; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0423; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0556; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0584; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0484; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0534; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0414; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0498; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.751656   0.692934   0.786424   0.704068   0.802980   0.708404  
Loss: 0.1936
Fold 1 Epoch 081; Train loss: 0.0482; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0845; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0652; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0199; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0730; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0267; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0454; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0365; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0340; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0849; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.761589   0.698602   0.793046   0.708995   0.811258   0.713517  
Loss: 0.1825
Fold 1 Epoch 091; Train loss: 0.0476; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0490; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0476; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0244; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0463; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0278; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0533; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0317; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0354; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0565; Time: 00:00:02
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.788079   0.719384   0.798013   0.722702   0.821192   0.728545  
Loss: 0.1763
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.786424   0.719482   0.806291   0.725983   0.819536   0.729315  
Loss: 0.1779
Fold 1: Final Test Loss: 0.1779, HR@5: 0.7864
[l2_decay candidate 1e-08] Fold 1: Loss = 0.1779
Tuning l2_decay based on loss: 100%|██████████| 4/4 [12:04<00:00, 182.83s/it]Tuning l2_decay based on loss: 100%|██████████| 4/4 [12:04<00:00, 181.02s/it]

Best l2_decay based on loss: 1e-08
Tuning data for l2_decay (loss) saved to ./item/tuning_l2.json
Tuning eps based on loss:   0%|          | 0/4 [00:00<?, ?it/s]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.6615; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.6606; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.6593; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.6581; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.6585; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.6611; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.6600; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.6594; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.6587; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.6596; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.004967   0.002067   0.006623   0.002565   0.008278   0.003000  
Loss: 0.6593
Fold 1 Epoch 011; Train loss: 0.6590; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.6598; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.6585; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.6591; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.6605; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.6590; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.6595; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.6594; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.6597; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.6587; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.004967   0.003134   0.006623   0.003686   0.014901   0.005773  
Loss: 0.6591
Fold 1 Epoch 021; Train loss: 0.6600; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.6592; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.6581; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.6574; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.6577; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.6584; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.6592; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.6579; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.6579; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.6577; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.009934   0.004839   0.009934   0.004839   0.018212   0.006833  
Loss: 0.6588
Fold 1 Epoch 031; Train loss: 0.6572; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.6584; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.6575; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.6573; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.6568; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.6597; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.6592; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.6597; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.6582; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.6565; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.009934   0.004623   0.014901   0.006151   0.026490   0.009092  
Loss: 0.6584
Fold 1 Epoch 041; Train loss: 0.6578; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.6591; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.6575; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.6580; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.6582; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.6571; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.6573; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.6569; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.6582; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.6577; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.011589   0.005926   0.018212   0.008088   0.031457   0.011268  
Loss: 0.6581
Fold 1 Epoch 051; Train loss: 0.6580; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.6561; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.6567; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.6593; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.6571; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.6586; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.6572; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.6575; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.6577; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.6570; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.011589   0.007913   0.021523   0.011241   0.051325   0.018654  
Loss: 0.6577
Fold 1 Epoch 061; Train loss: 0.6571; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.6579; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.6575; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.6562; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.6560; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.6566; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.6565; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.6592; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.6546; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.6568; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.014901   0.008160   0.033113   0.013951   0.054636   0.019496  
Loss: 0.6572
Fold 1 Epoch 071; Train loss: 0.6585; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.6560; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.6548; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.6567; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.6561; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.6569; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.6557; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.6551; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.6579; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.6578; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.023179   0.011002   0.041391   0.016667   0.056291   0.020528  
Loss: 0.6567
Fold 1 Epoch 081; Train loss: 0.6570; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.6544; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.6539; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.6565; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.6567; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.6545; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.6576; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.6547; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.6556; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.6527; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.024834   0.014726   0.041391   0.020111   0.062914   0.025656  
Loss: 0.6560
Fold 1 Epoch 091; Train loss: 0.6547; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.6548; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.6557; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.6556; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.6518; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.6547; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.6539; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.6542; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.6557; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.6511; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.024834   0.014654   0.048013   0.022134   0.061258   0.025519  
Loss: 0.6549
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.024834   0.014654   0.048013   0.022124   0.059603   0.025112  
Loss: 0.6549
Fold 1: Final Test Loss: 0.6549, HR@5: 0.0248
[eps candidate 0.1] Fold 1: Loss = 0.6549
Tuning eps based on loss:  25%|██▌       | 1/4 [02:51<08:33, 171.07s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.6589; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.6580; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.6574; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.6586; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.6584; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.6559; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.6562; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.6555; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.6545; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.6500; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.028146   0.016037   0.038079   0.019171   0.062914   0.025473  
Loss: 0.6518
Fold 1 Epoch 011; Train loss: 0.6363; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.6517; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.6122; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.6195; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.5954; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.5982; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.5776; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.5916; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.5797; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.5696; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.029801   0.021350   0.054636   0.029447   0.079470   0.035639  
Loss: 0.6062
Fold 1 Epoch 021; Train loss: 0.5415; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.5645; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.5699; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.5413; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.5670; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.5870; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.5620; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.5697; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.5592; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.5642; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.034768   0.028464   0.049669   0.033484   0.081126   0.041410  
Loss: 0.6068
Fold 1 Epoch 031; Train loss: 0.5197; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.5181; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.5044; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.5392; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.4995; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.5618; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.5463; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.5069; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.5506; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.5038; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.114238   0.086872   0.162252   0.102494   0.201987   0.112308  
Loss: 0.5697
Fold 1 Epoch 041; Train loss: 0.5243; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.4430; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.4187; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.4458; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.4705; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.4285; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.3686; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.3791; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.3503; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.3022; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.298013   0.239548   0.342715   0.254123   0.399007   0.268748  
Loss: 0.4860
Fold 1 Epoch 051; Train loss: 0.3284; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.2756; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.3583; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.3052; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.2670; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.2910; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.2130; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.2491; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.2516; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.2743; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.379139   0.317664   0.437086   0.336208   0.501656   0.352581  
Loss: 0.4639
Fold 1 Epoch 061; Train loss: 0.2950; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.2338; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.1881; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.2584; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.1978; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.2444; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.1455; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.2244; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.1998; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.1801; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.503311   0.408541   0.571192   0.429988   0.637417   0.446488  
Loss: 0.4256
Fold 1 Epoch 071; Train loss: 0.2315; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.1762; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.1820; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.2107; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.2160; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.2167; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.1438; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.1670; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.1662; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.1918; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.551325   0.471159   0.610927   0.490165   0.665563   0.504127  
Loss: 0.4175
Fold 1 Epoch 081; Train loss: 0.1352; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.1628; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.1516; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.1612; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.1596; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.1125; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.1743; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.1655; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.1336; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.1171; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.605960   0.539314   0.667219   0.559108   0.703642   0.568551  
Loss: 0.3881
Fold 1 Epoch 091; Train loss: 0.1348; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.1296; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.1093; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.1283; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.1153; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0985; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.1397; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.1715; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.1137; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.1065; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.605960   0.546040   0.658940   0.562822   0.706954   0.575012  
Loss: 0.4153
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.647351   0.575097   0.701987   0.593118   0.728477   0.599849  
Loss: 0.4010
Fold 1: Final Test Loss: 0.4010, HR@5: 0.6474
[eps candidate 0.01] Fold 1: Loss = 0.4010
Tuning eps based on loss:  50%|█████     | 2/4 [05:42<05:42, 171.12s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.5958; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.5593; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4407; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.4397; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.3598; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.2614; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2535; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2981; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2776; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.2480; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.466887   0.386401   0.543046   0.411212   0.627483   0.432798  
Loss: 0.3369
Fold 1 Epoch 011; Train loss: 0.2585; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.1542; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2063; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1778; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1637; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.2061; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1684; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1825; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1396; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.0948; Time: 00:00:01
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.662252   0.567052   0.713576   0.583478   0.746689   0.591609  
Loss: 0.2662
Fold 1 Epoch 021; Train loss: 0.0934; Time: 00:00:01
Fold 1 Epoch 022; Train loss: 0.1415; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1358; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1384; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.0744; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.0970; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.0841; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.1218; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.0958; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0823; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.701987   0.607432   0.740066   0.619945   0.769868   0.627475  
Loss: 0.2400
Fold 1 Epoch 031; Train loss: 0.0936; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0839; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0746; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0853; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.0908; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1099; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0921; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0688; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0832; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0587; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.733444   0.646713   0.766556   0.657496   0.786424   0.662554  
Loss: 0.2173
Fold 1 Epoch 041; Train loss: 0.0764; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0680; Time: 00:00:01
Fold 1 Epoch 043; Train loss: 0.0741; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0653; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0497; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0995; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0801; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0636; Time: 00:00:01
Fold 1 Epoch 049; Train loss: 0.0864; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0472; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.751656   0.676551   0.794702   0.690599   0.806291   0.693456  
Loss: 0.1939
Fold 1 Epoch 051; Train loss: 0.0523; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0630; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0896; Time: 00:00:01
Fold 1 Epoch 054; Train loss: 0.0639; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0866; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0505; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.1012; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0442; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0389; Time: 00:00:01
Fold 1 Epoch 060; Train loss: 0.0763; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.759934   0.680840   0.794702   0.692092   0.812914   0.696822  
Loss: 0.2000
Fold 1 Epoch 061; Train loss: 0.0489; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0514; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0465; Time: 00:00:01
Fold 1 Epoch 064; Train loss: 0.0518; Time: 00:00:01
Fold 1 Epoch 065; Train loss: 0.0294; Time: 00:00:01
Fold 1 Epoch 066; Train loss: 0.0510; Time: 00:00:01
Fold 1 Epoch 067; Train loss: 0.0390; Time: 00:00:01
Fold 1 Epoch 068; Train loss: 0.0555; Time: 00:00:01
Fold 1 Epoch 069; Train loss: 0.0327; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0729; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.764901   0.693379   0.788079   0.700674   0.802980   0.704383  
Loss: 0.1928
Fold 1 Epoch 071; Train loss: 0.0328; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0475; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0652; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0434; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0619; Time: 00:00:01
Fold 1 Epoch 076; Train loss: 0.0496; Time: 00:00:01
Fold 1 Epoch 077; Train loss: 0.0492; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0449; Time: 00:00:01
Fold 1 Epoch 079; Train loss: 0.0487; Time: 00:00:01
Fold 1 Epoch 080; Train loss: 0.0223; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.756623   0.692647   0.788079   0.702915   0.802980   0.706745  
Loss: 0.1900
Fold 1 Epoch 081; Train loss: 0.0505; Time: 00:00:01
Fold 1 Epoch 082; Train loss: 0.0422; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0560; Time: 00:00:01
Fold 1 Epoch 084; Train loss: 0.0147; Time: 00:00:01
Fold 1 Epoch 085; Train loss: 0.0412; Time: 00:00:01
Fold 1 Epoch 086; Train loss: 0.0278; Time: 00:00:01
Fold 1 Epoch 087; Train loss: 0.0742; Time: 00:00:01
Fold 1 Epoch 088; Train loss: 0.0650; Time: 00:00:01
Fold 1 Epoch 089; Train loss: 0.0545; Time: 00:00:01
Fold 1 Epoch 090; Train loss: 0.0433; Time: 00:00:01
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.774834   0.708344   0.804636   0.718129   0.816225   0.721304  
Loss: 0.1806
Fold 1 Epoch 091; Train loss: 0.0297; Time: 00:00:01
Fold 1 Epoch 092; Train loss: 0.0278; Time: 00:00:01
Fold 1 Epoch 093; Train loss: 0.0425; Time: 00:00:01
Fold 1 Epoch 094; Train loss: 0.0536; Time: 00:00:01
Fold 1 Epoch 095; Train loss: 0.0506; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0448; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0342; Time: 00:00:01
Fold 1 Epoch 098; Train loss: 0.0346; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0429; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0415; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.778146   0.717593   0.799669   0.724679   0.816225   0.728872  
Loss: 0.1829
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.798013   0.732468   0.816225   0.738382   0.822848   0.740158  
Loss: 0.1783
Fold 1: Final Test Loss: 0.1783, HR@5: 0.7980
[eps candidate 0.0001] Fold 1: Loss = 0.1783
Tuning eps based on loss:  75%|███████▌  | 3/4 [08:45<02:56, 176.88s/it]
========== Fold 1 ==========
3883
Fold 1 Epoch 001; Train loss: 0.6036; Time: 00:00:01
Fold 1 Epoch 002; Train loss: 0.4911; Time: 00:00:01
Fold 1 Epoch 003; Train loss: 0.4140; Time: 00:00:01
Fold 1 Epoch 004; Train loss: 0.3641; Time: 00:00:01
Fold 1 Epoch 005; Train loss: 0.2974; Time: 00:00:01
Fold 1 Epoch 006; Train loss: 0.2967; Time: 00:00:01
Fold 1 Epoch 007; Train loss: 0.2531; Time: 00:00:01
Fold 1 Epoch 008; Train loss: 0.2668; Time: 00:00:01
Fold 1 Epoch 009; Train loss: 0.2966; Time: 00:00:01
Fold 1 Epoch 010; Train loss: 0.1857; Time: 00:00:01
Fold 1: Evaluation at Epoch 10
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.403974   0.294902   0.486755   0.321661   0.567881   0.342258  
Loss: 0.3820
Fold 1 Epoch 011; Train loss: 0.2039; Time: 00:00:01
Fold 1 Epoch 012; Train loss: 0.2413; Time: 00:00:01
Fold 1 Epoch 013; Train loss: 0.2145; Time: 00:00:01
Fold 1 Epoch 014; Train loss: 0.1887; Time: 00:00:01
Fold 1 Epoch 015; Train loss: 0.1637; Time: 00:00:01
Fold 1 Epoch 016; Train loss: 0.1910; Time: 00:00:01
Fold 1 Epoch 017; Train loss: 0.1636; Time: 00:00:01
Fold 1 Epoch 018; Train loss: 0.1421; Time: 00:00:01
Fold 1 Epoch 019; Train loss: 0.1451; Time: 00:00:01
Fold 1 Epoch 020; Train loss: 0.1318; Time: 00:00:02
Fold 1: Evaluation at Epoch 20
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.559603   0.435722   0.620861   0.455886   0.705298   0.477429  
Loss: 0.2943
Fold 1 Epoch 021; Train loss: 0.1037; Time: 00:00:02
Fold 1 Epoch 022; Train loss: 0.1546; Time: 00:00:01
Fold 1 Epoch 023; Train loss: 0.1355; Time: 00:00:01
Fold 1 Epoch 024; Train loss: 0.1408; Time: 00:00:01
Fold 1 Epoch 025; Train loss: 0.1287; Time: 00:00:01
Fold 1 Epoch 026; Train loss: 0.1023; Time: 00:00:01
Fold 1 Epoch 027; Train loss: 0.1374; Time: 00:00:01
Fold 1 Epoch 028; Train loss: 0.0910; Time: 00:00:01
Fold 1 Epoch 029; Train loss: 0.1213; Time: 00:00:01
Fold 1 Epoch 030; Train loss: 0.0911; Time: 00:00:01
Fold 1: Evaluation at Epoch 30
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.642384   0.537353   0.730132   0.566119   0.778146   0.578462  
Loss: 0.2614
Fold 1 Epoch 031; Train loss: 0.0980; Time: 00:00:01
Fold 1 Epoch 032; Train loss: 0.0941; Time: 00:00:01
Fold 1 Epoch 033; Train loss: 0.0869; Time: 00:00:01
Fold 1 Epoch 034; Train loss: 0.0945; Time: 00:00:01
Fold 1 Epoch 035; Train loss: 0.1106; Time: 00:00:01
Fold 1 Epoch 036; Train loss: 0.1104; Time: 00:00:01
Fold 1 Epoch 037; Train loss: 0.0683; Time: 00:00:01
Fold 1 Epoch 038; Train loss: 0.0909; Time: 00:00:01
Fold 1 Epoch 039; Train loss: 0.0894; Time: 00:00:01
Fold 1 Epoch 040; Train loss: 0.0689; Time: 00:00:01
Fold 1: Evaluation at Epoch 40
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.711921   0.608875   0.773179   0.629221   0.807947   0.638383  
Loss: 0.2335
Fold 1 Epoch 041; Train loss: 0.0981; Time: 00:00:01
Fold 1 Epoch 042; Train loss: 0.0908; Time: 00:00:02
Fold 1 Epoch 043; Train loss: 0.0965; Time: 00:00:01
Fold 1 Epoch 044; Train loss: 0.0650; Time: 00:00:01
Fold 1 Epoch 045; Train loss: 0.0827; Time: 00:00:01
Fold 1 Epoch 046; Train loss: 0.0634; Time: 00:00:01
Fold 1 Epoch 047; Train loss: 0.0650; Time: 00:00:01
Fold 1 Epoch 048; Train loss: 0.0559; Time: 00:00:02
Fold 1 Epoch 049; Train loss: 0.0505; Time: 00:00:01
Fold 1 Epoch 050; Train loss: 0.0638; Time: 00:00:01
Fold 1: Evaluation at Epoch 50
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.733444   0.626289   0.779801   0.641608   0.801325   0.647227  
Loss: 0.2297
Fold 1 Epoch 051; Train loss: 0.0366; Time: 00:00:01
Fold 1 Epoch 052; Train loss: 0.0598; Time: 00:00:01
Fold 1 Epoch 053; Train loss: 0.0665; Time: 00:00:02
Fold 1 Epoch 054; Train loss: 0.0390; Time: 00:00:01
Fold 1 Epoch 055; Train loss: 0.0539; Time: 00:00:01
Fold 1 Epoch 056; Train loss: 0.0696; Time: 00:00:01
Fold 1 Epoch 057; Train loss: 0.0699; Time: 00:00:01
Fold 1 Epoch 058; Train loss: 0.0496; Time: 00:00:01
Fold 1 Epoch 059; Train loss: 0.0478; Time: 00:00:02
Fold 1 Epoch 060; Train loss: 0.0541; Time: 00:00:01
Fold 1: Evaluation at Epoch 60
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.748344   0.649204   0.807947   0.668802   0.822848   0.672638  
Loss: 0.2131
Fold 1 Epoch 061; Train loss: 0.0461; Time: 00:00:01
Fold 1 Epoch 062; Train loss: 0.0482; Time: 00:00:01
Fold 1 Epoch 063; Train loss: 0.0649; Time: 00:00:02
Fold 1 Epoch 064; Train loss: 0.0504; Time: 00:00:02
Fold 1 Epoch 065; Train loss: 0.0367; Time: 00:00:02
Fold 1 Epoch 066; Train loss: 0.0527; Time: 00:00:02
Fold 1 Epoch 067; Train loss: 0.0432; Time: 00:00:02
Fold 1 Epoch 068; Train loss: 0.0401; Time: 00:00:02
Fold 1 Epoch 069; Train loss: 0.0704; Time: 00:00:01
Fold 1 Epoch 070; Train loss: 0.0382; Time: 00:00:01
Fold 1: Evaluation at Epoch 70
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.779801   0.687713   0.799669   0.694298   0.817881   0.698922  
Loss: 0.2116
Fold 1 Epoch 071; Train loss: 0.0622; Time: 00:00:01
Fold 1 Epoch 072; Train loss: 0.0511; Time: 00:00:01
Fold 1 Epoch 073; Train loss: 0.0504; Time: 00:00:01
Fold 1 Epoch 074; Train loss: 0.0731; Time: 00:00:01
Fold 1 Epoch 075; Train loss: 0.0385; Time: 00:00:02
Fold 1 Epoch 076; Train loss: 0.0353; Time: 00:00:02
Fold 1 Epoch 077; Train loss: 0.0255; Time: 00:00:01
Fold 1 Epoch 078; Train loss: 0.0300; Time: 00:00:02
Fold 1 Epoch 079; Train loss: 0.0370; Time: 00:00:02
Fold 1 Epoch 080; Train loss: 0.0505; Time: 00:00:01
Fold 1: Evaluation at Epoch 80
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.786424   0.707725   0.814570   0.716684   0.822848   0.718848  
Loss: 0.1990
Fold 1 Epoch 081; Train loss: 0.0302; Time: 00:00:02
Fold 1 Epoch 082; Train loss: 0.0326; Time: 00:00:01
Fold 1 Epoch 083; Train loss: 0.0491; Time: 00:00:02
Fold 1 Epoch 084; Train loss: 0.0263; Time: 00:00:02
Fold 1 Epoch 085; Train loss: 0.0249; Time: 00:00:02
Fold 1 Epoch 086; Train loss: 0.0328; Time: 00:00:02
Fold 1 Epoch 087; Train loss: 0.0345; Time: 00:00:02
Fold 1 Epoch 088; Train loss: 0.0421; Time: 00:00:02
Fold 1 Epoch 089; Train loss: 0.0222; Time: 00:00:02
Fold 1 Epoch 090; Train loss: 0.0328; Time: 00:00:02
Fold 1: Evaluation at Epoch 90
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.802980   0.740207   0.824503   0.747331   0.827815   0.748228  
Loss: 0.1870
Fold 1 Epoch 091; Train loss: 0.0387; Time: 00:00:02
Fold 1 Epoch 092; Train loss: 0.0205; Time: 00:00:02
Fold 1 Epoch 093; Train loss: 0.0291; Time: 00:00:02
Fold 1 Epoch 094; Train loss: 0.0182; Time: 00:00:02
Fold 1 Epoch 095; Train loss: 0.0329; Time: 00:00:01
Fold 1 Epoch 096; Train loss: 0.0321; Time: 00:00:01
Fold 1 Epoch 097; Train loss: 0.0173; Time: 00:00:02
Fold 1 Epoch 098; Train loss: 0.0435; Time: 00:00:01
Fold 1 Epoch 099; Train loss: 0.0396; Time: 00:00:01
Fold 1 Epoch 100; Train loss: 0.0285; Time: 00:00:01
Fold 1: Evaluation at Epoch 100
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.807947   0.728538   0.822848   0.733665   0.826159   0.734484  
Loss: 0.1883
Fold 1: Final Test Phase
HR@5       NDCG@5     HR@10      NDCG@10    HR@20      NDCG@20   
0.804636   0.714163   0.826159   0.721206   0.829470   0.722003  
Loss: 0.1921
Fold 1: Final Test Loss: 0.1921, HR@5: 0.8046
[eps candidate 1e-08] Fold 1: Loss = 0.1921
Tuning eps based on loss: 100%|██████████| 4/4 [12:03<00:00, 184.91s/it]Tuning eps based on loss: 100%|██████████| 4/4 [12:03<00:00, 180.79s/it]

Best eps based on loss: 0.0001
Tuning data for eps (loss) saved to ./item/tuning_eps.json
Best candidates saved to ./item/best_candidates.json
